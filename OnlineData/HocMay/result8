MỤC LỤC TÀI LIỆU THAM KHẢO & TRÍCH DẪN Võ Hồng Phong Luận văn tốt nghiệp LIỆT KÊ CÁC HÌNH Hình 2.1a, b, c, d: Các đặc trưng cạnh, đường, bao quanh tâm, đường chéo Hình 2.2 : Ảnh chia nhỏ tại tọa độ (x,y) Hình 2.3 : Tổng các giá trị pixel nằm trong vùng A Hình 2.4 : Ví dụ về các tư thế của hình chữ nhật đặc trưng Hình 2.5 : Lược đồ cơ bản của AdaBoost Hình 2.6 : Thuật toán học AdaBoost Hình 2.7 : Mô hình minh họa tác vụ phát hiện vật thể dùng chuỗi cascade Hình 2.8 : Dùng chuỗi cascade đã được huấn luyện để phát hiện cửa sổ con phù hợp Hình 2.9 : Cấu trúc các chuỗi cascade song song Hình 2.10 : Cấu trúc các chuỗi cascade nối tiếp, với N giai đoạn học huấn luyện Hình 3.1 : Minh họa quá trình lấy mẫu Hình 3.2 : Minh họa quá trình học huấn luyện Hình 3.3 : Minh họa quá trình kiểm thử cơ sở dữ liệu “car_back.xml” Hình 3.4 : Minh họa quá trình kiểm thử cơ sở dữ liệu “bus_vn_full_22112008.xml” Hình 3.5 : Minh họa quá trình kiểm thử cơ sở dữ liệu “truck_vn_26112008.xml” Hình 3.6 : Sơ đồ khối của quá trình nhận dạng xe Hình 3.7 : Mô hình hóa thuật toán ước lượng khoảng cách Hình 3.8 : Mô hình camera quan sát trong không gian 3-D Hình 3.9 : Minh họa kết quả ước lượng khoảng cách Hình 3.10 : Minh họa kết quả đếm số lượng xe có trong hình Hình 3.11 : Sơ đồ khối tổ chức phần mềm hệ thống Hình 3.12 : Sơ đồ khối hệ thống hoàn chỉnh tổ chức phần mềm hệ thống Hình 3.13 : Mô tả hệ thống phát hiện xe dùng thuật toán Haar Hình 3.14 : Giao diện chương trình nhận dạng xe Hình 3.15 : Mẫu camera được sử dụng trong luận văn Trang 2 Võ Hồng Phong Luận văn tốt nghiệp LIỆT KÊ CÁC BẢNG Bảng 2.1 : Các dạng thuật toán học huấn luyện AdaBoost Bảng 2.2 : Thuật toán phát hiện đồng thời co giãn vùng đặc trưng đối tượng Bảng 3.1 Bảng 3.1a : Mẫu xe hơi du lịch cá nhân Bảng 3.1b : Mẫu xe buýt Bảng 3.1c : Mẫu xe tải Bảng 3.2 : Cấu trúc file cơ sở dữ liệu đặc trưng của đối tượng xe hơi cá nhân Bảng 3.3 : Kết quả kiểm thử cơ sở dữ liệu đặc trưng xe hơi cá nhân Bảng 3.4 : Kết quả kiểm thử cơ sở dữ liệu đặc trưng xe buýt Bảng 3.5 : Kết quả kiểm thử cơ sở dữ liệu đặc trưng xe tải Bảng 3.6 : Tổng kết các kết quả kiểm thử cơ sở dữ liệu Bảng 3.7 : Mã lệnh điển hình của thuật toán phát hiện và nhận dạng xe hơi Bảng 3.8 : Mã lệnh thực hiện thuật toán ước lượng khoảng cách Bảng 3.9 : Mã lệnh thực hiện thuật toán đếm xe Bảng 4.1 : Các kết quả xử lý nhận dạng Bảng 4.1a : Kết quả xử lý nhận dạng xe buýt Bảng 4.1b : Kết quả xử lý nhận dạng xe hơi cá nhân Bảng 4.1c : Kết quả xử lý nhận dạng tải Bảng 4.2 : Kết quả xử lý nhận dạng xe tổng hợp Bảng 4.3 : Đánh giá độ chính xác trong nhận dạng của phần mềm luận văn Trang 3 Võ Hồng Phong Luận văn tốt nghiệp PHẦN A GIỚI THIỆU Trang 4 Võ Hồng Phong Luận văn tốt nghiệp Đại Học Quốc Gia Tp. Hồ Chí Minh CỘNG HOÀ XÃ HỘI CHỦ NGHĨA VIỆT NAM TRƯỜNG ĐẠI HỌC BÁCH KHOA Độc Lập – Tự Do – Hạnh Phúc - - - - - - - - o O o - - - - - - - - NHIỆM VỤ LUẬN VĂN THẠC SĨ Họ và tên học viên : VÕ HỒNG PHONG Phái : Nam Ngày tháng năm sinh : 22/02/1982 Nơi sinh : Khánh Hòa Chuyên ngành : TỰ ĐỘNG HOÁ Mã số HV : 01506364 I. TÊN ĐỀ TÀI: NHẬN DẠNG XE TRÊN CƠ SỞ THỊ GIÁC MÁY TÍNH II. NHIỆM VỤ: - Phân tích và tổng hợp các phương pháp nhận dạng xe. - Xây dựng chương trình nhận dạng xe dựa trên công cụ Thị giác máy tính. III. NGÀY GIAO NHIỆM VỤ: ngày 30 tháng 01 năm 2008 IV. NGÀY HOÀN THÀNH NHIỆM VỤ: ngày 30 tháng 11 năm 2008 V. CÁN BỘ HƯỚNG DẪN: TS. TRƯƠNG ĐÌNH CHÂU Giáo Viên Hướng Dẫn Chủ Nhiệm Ngành Bộ Môn Nội dung và đề cương Luận văn Thạc sĩ đã được Hội Đồng Chuyên Ngành thông qua. Ngày ….. tháng ….. năm 200… PHÒNG ĐÀO TẠO SAU ĐẠI HỌC KHOA QUẢN LÝ NGÀNH Trang 5 Võ Hồng Phong Luận văn tốt nghiệp LỜI CẢM ƠN Trước tiên, xin cảm ơn thầy TS Trương Đình Châu vì đã gợi mở, quan tâm, giúp đỡ cho học viên trong suốt thời gian thực hiện đề tài tốt nghiệp này. Bên cạnh đó, học viên cũng xin gởi lời cảm ơn đến tất cả những thầy cô đã trực tiếp giảng dạy trong suốt khóa học; những người bạn đã quan tâm, động viên và chia sẻ kiến thức cũng như kinh nghiệm chuyên ngành trong quá trình học tập và rèn luyện vừa qua của học viên. Cũng xin chân thành cảm ơn sự quan tâm hỗ trợ, tạo điều kiện và hết lòng động viên về tinh thần lẫn vật chất của các thành viên trong gia đình trong suốt thời gian qua. Sau cùng, học viên gởi lời chúc sức khỏe, hạnh phúc đến quý thầy cô, gia đình và bạn bè. Trường Đại học Bách Khoa Tp. Hồ Chí Minh Tháng 11 năm 2008 Học viên Võ Hồng Phong Trang 6 Võ Hồng Phong Luận văn tốt nghiệp LÝ LỊCH TRÍCH NGANG Họ và tên : VÕ HỒNG PHONG Phái : Nam Ngày sinh : 22-02-1982 Nơi sinh : Tp Nha Trang – tỉnh Khánh Hòa Hộ khẩu TT : 8/C3 Âu Cơ – phường 10 – quận Tân Bình – Tp HCM Địa chỉ email : vhphong_nt@yahoo.com.vn hoặc vhphong@gmail.com QUÁ TRÌNH ĐÀO TẠO: 9/2000 – 4/2005 : Sinh viên khoa Điện - Điện tử, bộ môn Kỹ thuật Điện tử - hệ chính quy - trường ĐH SPKT Tp HCM. 9/2006 đến nay : học viên cao học Khoa Điện – Điện tử, chuyên ngành Tự động hóa - hệ chính quy – trường ĐH Bách Khoa Tp HCM. QUÁ TRÌNH CÔNG TÁC: 2005 – 11/2006 : Quản trị mạng tại Công ty Phần mềm Sài gòn (SSP – Saigon Software Park). Trang 7 Võ Hồng Phong Luận văn tốt nghiệp ABSTRACT Now, in the age of the 21st century, thanks for the high speed development of Science and Technology, human is inventing and processing many scientific projects with theirs mega-structures. From the alternatives of machines and engines instead of human in works which required a high-level of decision and concentrating, the results, facts and effects is being trusted. These things are really huge meaning, thus increases values of lives ‘s quality days by days. In this thesis, issues named “Vehicles Detection and Recognition Based on Computer Vision”, also have same ways of thinking above. This is one of the most amazing applications and projects which is resrearched and approached by many sci entists who working in fields of “Computer Vision” and “Digital Image Processing” cause of demands in real lives and diversified approaching methods. This project shows some problems which related to the basic knowledge that being built on contents within. The author used tools called “OpenCV” to apply Haar-like features that ran on Visual C++.NET environment and AdaBoost (Adaptive Boost) algorithms to speed up the detection and recognition processing on all perspectives and types of vehicles. Results have got a feature called “real- time effects” in detection and recognition. This is importance for modifying traffics, controlling lanes, extracting information of vehicles, … Trang 8 Võ Hồng Phong Luận văn tốt nghiệp TÓM TẮT LUẬN VĂN THẠC SĨ Trong thời đại của thế kỷ 21, với sự phát triển nhảy vọt của trình độ Khoa học kỹ thuật, con người đã tạo nên và phát triển nhiều công trình khoa học mang tính tầm cỡ. Với sự thay thế dần của máy móc cho con người trong các nhiệm vụ mang tính chính xác và tập trung cao thì kết quả đạt được đã hoàn toàn được tin cậy và đánh giá cao. Điều này thực sự có ý nghĩa to lớn và góp phần tăng thêm giá trị và chất lượng cuộc sống. Đề tài luận văn này, nhận dạng xe trên cơ sở thị giác máy tính, cũng không nằm ngoài ý nghĩa đó. Đây là một dạng ứng dụng thú vị mà nhiều nhà khoa học đã, đang và sẽ không ngừng nghiên cứu vì nhu cầu thực tiễn và đa dạng phương pháp tiếp cận. Trong đề tài này sẽ trình bày trong đó các vấn đề liên quan tới kiến thức nền tảng xây dựng nên luận văn. Học viên đã sử dụng công cụ OpenCV ứng dụng các đặc trưng Haar-like chạy trên nền tảng Visual C++.NET và thuật toán tăng tốc AdaBoost nhằm nâng cao tốc độ phát hiện và nhận dạng các hình thái khác nhau của xe. Kết quả thu được có đặc tính thời gian thực các diễn tiến của quá trình phát hiện và nhận dạng xe. Nội dung luận văn gồm 5 chương: Chương 1: Giới thiệu tổng quan Chương 2: Cơ sở lý thuyết Chương 3: Xây dựng hệ thống Chương 4: Kết quả - Nhận xét – Phân tích Chương 5: Kết luận và hướng phát triển đề tài Trang 9 Võ Hồng Phong Luận văn tốt nghiệp PHẦN B NỘI DUNG Trang 10 Võ Hồng Phong Luận văn tốt nghiệp CHƯƠNG 1 GIỚI THIỆU TỔNG QUAN 1.1 GIỚI THIỆU Thị giác là giác quan cho phép con người cũng như hầu hết các loài động vật khác thu thập thông tin nhanh nhất, tinh tế nhất và cũng là kênh thông tin trao đổi tin cậy giúp đưa ra những quyết định kịp thời và nhanh chóng trong hầu hết các hoạt động trong thực tế của con người. Vì vậy, với ý nghĩa vô cùng quan trọng đó, cùng với sự phát triển của khoa học kĩ thuật và ứng dụng của nó trong nhiều lĩnh vực đã được tiến hành rộng rãi, nhất là trong ứng dụng liên quan tới xử lý ảnh của đối tượng cụ thể là xe hơi trong cảnh quang giao thông, đặc biệt là trong tình trạng xe đang chuyển động. Từ giữa thế kỷ XX đến nay, đặc biệt là từ thập niên 80, ngày càng có nhiều ứng dụng có chức năng phát hiện vật thể, ví dụ như xe hơi, là một công việc khó trong lĩnh vực xử lý ảnh. Chức năng này đặc biệt hữu dụng trong rất nhiều môi trường và lĩnh vực khác nhau (bao gồm an ninh, thị giác người máy, giải trí, điều tiết giao thông, …). Hàng loạt các cuộc nghiên cứu và thử nghiệm về vấn đề tự động nhận dạng xe hơi đã được tiến hành mạnh mẽ, song song cùng lúc với sự phát triển mạnh mẽ của hệ thống giao thông trên thế giới cũng như ở Việt Nam, là một ví dụ minh chứng bởi tính cụ thể, đa dạng, phức tạp và cấp thiết. Trang 11 Võ Hồng Phong Luận văn tốt nghiệp Thông thường, các đặc tính của xử lý và phân tích ảnh chủ yếu bị ảnh hưởng bởi đặc tính của ảnh tĩnh và ảnh động (video). Các lý do có thể đưa ra là: vị trí tương quan giữa máy ảnh và đối tượng, xe bị che khuất một phần hoặc toàn phần; sự kết hợp của các đặc điểm xe cộ, kích thước, màu sắc, ảnh hưởng của cảnh nền (độ sáng chói, độ tương phản, nhiễu giống đối tượng, …) là rất khác nhau, và nó ảnh hưởng đến chất lượng của quá trình phát hiện và nhận dạng xe. Còn ảnh hưởng về mặt chủ quan cũng có thể kể đến như hướng quan sát ghi hình của camera, hướng ánh sáng, đặc tính kỹ thuật của máy ảnh, camera, tốc độ hệ thống máy xử lý chủ (máy tính PC hoặc laptop) cũng gây ra ảnh hưởng không nhỏ đến đề tài. 1.2 MỤC ĐÍCH NGHIÊN CỨU Hệ thống nhận dạng xe dùng trong quan sát giao thông là một ứng dụng quan trọng trong cuộc sống hiện đại hàng ngày. Với hệ thống như vậy thì một thuật toán phát hiện và nhận dạng theo thời gian thực là cần thiết khi đầu vào của hệ thống là một chuỗi hình ảnh video. Việc ứng dụng một thuật toán để giải quyết vấn đề phát hiện xe là một trong những khâu quan trọng trong hệ thống quan trắc giao thông. Tác vụ này phát hiện các loại xe trong tầm khoảng cách trung bình và tầm khoảng cách xa (trên 20m). [9, trang 13 ÷ 15] [12, trang 410 ÷ 411] 1.3 CÁC ĐỀ TÀI ĐÃ NGHIÊN CỨU VÀ HƯỚNG NGHIÊN CỨU ĐỀ NGHỊ Cho đến nay, có rất nhiều các đề tài nghiên cứu về hệ thống phát hiện và nhận dạng xe mà chủ yếu là thực hiện trong các phòng thí nghiệm Khoa học máy tính của các trường Đại học trên thế giới [1][2]. Các nghiên cứu này chủ yếu xoay quanh vấn đề tìm hướng tiếp cận và xây dựng mô hình thuật toán phát hiện và nhận dạng xe trong việc quan sát giao thông nói chung. Trang 12 Võ Hồng Phong Luận văn tốt nghiệp Các đề tài này, phần lớn đã nêu bật được phương pháp “Lưu lượng quang”, đây là phương pháp điển hình cho việc quan trắc hệ thống các vật thể chuyển động có quỹ đạo nói chung hoặc hệ thống xe tham gia giao thông nói riêng [1][2][12]. Ngoài ra, còn có phương pháp xử lý trên pixel đặc trưng đối tượng, chủ yếu là phân tích diện tích và chu vi đường bao điểm ảnh của đối tượng, coi đó là đặc trưng của loại xe quan sát. Nhưng bên cạnh đó, chỉ một số ít các đề tài lại ít sử dụng phương pháp phân tích và dò tìm đặc trưng Haar-like. Do vậy, trong luận văn này, để có thể đáp ứng tốt các yêu cầu về độ tin cậy, ổn định trong việc quan trắc hệ thống giao thông, thì học viên đề nghị sử dụng phương pháp Haar-like để phát hiện xe trên cơ sở thuật toán trích đặc trưng AdaBoost. 1.4 TỔNG QUAN VỀ PHÁT HIỆN VÀ NHẬN DẠNG XE Bài toán phát hiện và nhận dạng xe hơi cụ thể gồm qua 2 bước. 1.4.1 Phát hiện xe Phát hiện xe là thuật toán chuyên biệt xuất phát từ thuật toán phát hiện vật thể. Khi cho một nguồn ảnh đầu vào (có thể là tín hiệu hình từ camera hoặc từ một file video định dạng AVI), thuật toán xác định xem trong khung hình nhận được đó có xe đang được kỳ vọng hay không. Nếu có xe thì ngay lập tức chỉ ra vị trí và phạm vi chiếm chỗ của đối tượng xe đó có trong ảnh. Đây là bước quan trọng đầu tiên trong hầu hết các ứng dụng phân tích vật thể nói chung và xe tham gia giao thông nói riêng (ví dụ: nhận dạng kiểu dáng xe, định vị xe trong ảnh, bám theo xe, nhận biết vị trí và tư thế của xe có trong ảnh,…). Trang 13 Võ Hồng Phong Luận văn tốt nghiệp 1.4.2 Nhận dạng xe Với kết quả phát hiện xe ở bước trên, từ đó so sánh với cơ sở dữ liệu đã được xây dựng sẵn để tiến hành nhận dạng được kiểu dáng xe đó là loại xe nào. Tư thế quan sát xe từ camera, vị trí của xe so với camera và các thông tin liên quan luôn được cập nhật tức thời bởi máy tính. 1.5 LÝ DO THỰC HIỆN ĐỀ TÀI Nắm được ý nghĩa quan trọng của kênh thông tin thu được trong hầu hết các tình huống dưới dạng hình ảnh. Sự phát triển mạnh mẽ và đa dạng của xã hội với nhiều nghiên cứu và ứng dụng thuộc lĩnh vực này luôn được tiến hành và áp dụng rộng rãi trong nhiều ngành nghề và lĩnh vực khoa học kỹ thuật khác nhau trên thế giới, đặc biệt là phát hiện và nhận dạng xe hơi. Bài toán phát hiện và nhận dạng xe được nhiều nhóm các nhà khoa học quan tâm và thực hiện nhưng để đáp ứng được vấn đề xử lý trong thời gian thực là một vấn đề tương đối khó. Thực tế cho thấy các kết quả còn hạn chế, tốc độ xử lý chậm, quá trình xử lý nhiều nhóm lệnh trên máy tính chủ khiến cho tốc độ bị trì hoãn mặc dù không nhiều. Vì vậy, nghiên cứu ứng dụng đề tài phát hiện và nhận dạng xe xử lý trên cơ sở thị giác máy tính trong thời gian thực mang tính cấp thiết. 1.6 MỤC TIÊU ĐỀ TÀI Nghiên cứu ứng dụng phát hiện nhận dạng xe trên cơ sở thị giác máy tính, đáp ứng trong thời gian thực. Trang 14 Võ Hồng Phong Luận văn tốt nghiệp 1.7 NHIỆM VỤ LUẬN VĂN  Phân tích và tổng hợp các phương pháp nhận dạng xe.  Xây dựng chương trình nhận dạng xe dựa trên công cụ Thị giác máy tính. 1.7.1 Phạm vi thực hiện  Về lý thuyết: phương pháp phù hợp phát hiện và nhận dạng xe.  Về ứng dụng: chương trình phần mềm phát hiện và nhận dạng xe.  Các điều kiện thực hiện: camera ghi hình trực diện từ phía sau đuôi của xe, cường độ ánh sáng là 300 ÷ 500 lux (độ sáng tiêu chuẩn bình thường) hoặc ánh sáng ngoài trời ban ngày bình thường.  Đối tượng là các loại xe với các hình dáng khác nhau (xe hơi cá nhân, xe buýt, xe tải container). Việc nhận dạng được thực hiện từ phía sau đuôi của xe. 1.7.2 Dự kiến các lĩnh vực ứng dụng của đề tài  Giám sát an ninh  Quan sát và điều tiết giao thông Trang 15 Võ Hồng Phong Luận văn tốt nghiệp CHƯƠNG 2 CƠ SỞ LÝ THUYẾT 2.1 CÁC PHƯƠNG PHÁP PHÁT HIỆN HÌNH ẢNH XE Phát hiện hay phát hiện đối tượng chuyên biệt, ví dụ như xe hơi trong cảnh quang giao thông, liệu có xuất hiện trong ảnh thu được từ camera (hình động) hay những tấm hình tĩnh dựa trên sự trợ giúp của máy tính từ lâu đã được con người nghiên cứu và phát triển bởi nó đóng vai trò là cơ sở chung và là nền tảng để nghiên cứu và ứng dụng trong các lĩnh vực và các hệ thống khác. Trong quá trình nghiên cứu và phát triển, thì yêu cầu được đặt lên hàng đầu là yếu tố chính xác và phải thực hiện nhanh chóng trong thời gian thực. Do vậy, việc này cần có sự phối hợp và bổ sung chặt chẽ cho nhau của hai lĩnh vực là Xử lý ảnh (Image Processing) và Thị giác máy tính (Computer Vision). Có rất nhiều phương pháp và hướng tiếp cận của vấn đề phát hiện xe hơi. Định vị xe trong một cảnh quang giao thông là phương pháp đơn giản, bởi vì nó chỉ xác định vị trí hay tọa độ của chiếc xe có trong ảnh đó mà thôi. Việc tiếp theo là nhận dạng (vehicle recognition) là công việc phức tạp hơn. Tác vụ này sẽ so sánh một ảnh của xe hơi trong ảnh đầu vào với tất cả các ảnh có trong cơ sở dữ liệu đã được huấn luyện trước đó và đưa ra ảnh gần nhất. Trang 16 Võ Hồng Phong Luận văn tốt nghiệp Có hai hướng tiếp cận chính thường được sử dụng để phát hiện xe: các phương pháp dựa trên ảnh và các phương pháp dựa trên dạng hình học. Các phương pháp có thể được liệt kê ra như sau [9, trang 17÷ 25] 2.1.1 Phát hiện dựa trên ảnh Các phương pháp thuộc nhóm này dựa trên một tập hợp các hình mẫu của đối tượng và sử dụng cửa sổ trượt để phát hiện xe. Cách làm này khác biệt so với các phương pháp dựa trên khuôn mẫu (cần thiết phải có sẵn mô hình xe, hình thái xe). Để trích đặc trưng từ các mẫu ví dụ, cần phải thực hiện việc cho học huấn luyện dưới dạng thống kê hoặc các thuật toán học máy (machine learning) với đủ nhiều các mẫu ảnh có chứa đối tượng xe và không chứa đối tượng xe. Do sự xuất hiện của xe trong ảnh là ngẫu nhiên với nhiều góc quan sát khác nhau nên thường phải xấp xỉ chúng để tạo nên sự phân biệt của hai đối tượng. Tùy theo cách tiếp cận xác xuất nào mà sẽ xuất hiện các phương pháp phát hiện tương ứng. Liệt kê dưới đây là một số các phương pháp thuộc nhóm này:  Phương pháp EigenObjects (PCA)  Phương pháp Fisher ‘s Linear Discriminant  Các phương pháp dựa trên Eigen-space  Các phương pháp dựa trên mang nơ-ron nhân tạo  Support Vector Machine – SVM  Phương pháp Mô hình Markov ẩn (Hidden Markov Model – HMM)  Phương pháp Sparse Network of Winnows (SNoW) Do nhóm phương pháp này dựa trên việc huấn luyện sao cho thu được mô hình đối tượng xe từ một tập dữ liệu tích cực (positive - ảnh có chứa hình xe hơi) và Trang 17 Võ Hồng Phong Luận văn tốt nghiệp một tập dữ liệu không tích cực (negative - ảnh không chứa hình đối tượng) nên chúng có sự tương quan so sánh trực tiếp đến các đặc điểm hình học của một kiểu xe điển hình. Nhược điểm của phương pháp này đòi hòi phải luôn có sẵn cơ sở dữ liệu hình xe rất lớn. Để có thể phát hiện và nhận dạng được xe, máy tính phải luôn dò trong cơ sở dữ liệu hình này rồi mới đưa ra kết quả. 2.1.2 Phát hiện dựa trên dạng hình học Khác với nhóm phương pháp vừa nêu ở trên, các phương pháp thuộc nhóm này quan tâm đến các đặc điểm cấu trúc hình học của xe. Vì vậy chúng còn được gọi là nhóm tiếp cận dựa trên đặc trưng (feature - based). Tùy theo cách triển khai vấn đề mà chúng được chia thành hai phân nhóm:  Các phương pháp Bottom – Up  Phương pháp dựa trên luồng ánh sáng (hay lưu lượng quang - optical flow) Nhóm phương pháp Bottom – Up chủ yếu dùng các đặc điểm hình dáng bất biến của xe đối với ngoại cảnh và nền ảnh để phát hiện ra xe. Rồi tùy vào mối liên hệ của chúng với nhau mà thiết lập các liên kết giữa các đặc điểm bất biến này ngay trong ảnh đầu tiên, tiếp theo sẽ dựa vào đó mà tìm chúng trên các ảnh kế tiếp. Phương pháp của phân nhóm thứ hai, luồng ánh sáng, là phương pháp xử lý tổng quan ánh sáng theo tuần tự các bước. Thứ nhất, thuật toán tìm đặc trưng quan trọng của đối tượng (ví dụ như góc của xe) trong hai khung hình liên tiếp nhau. Thứ hai, dùng thuật toán để hợp nhất tính liên quan đồng nhất giữa các đặc trưng đó (trong trường hợp này là góc của xe). Bước cuối cùng, các luồng đặc trưng đối Trang 18 Võ Hồng Phong Luận văn tốt nghiệp tượng đã được trích xuất khỏi ảnh được tập hợp lại thành một nhóm nếu các khoảng cách Euclide của các luồng (vị trí đối tượng và hướng chuyển động của đối tượng) là nhỏ. [1, phần 2.1] Cụ thể, phương pháp này không chỉ sử dụng các thuật toán học (learning algorithm) để huấn luyện tạo các bộ phân lớp (cascade) bằng các hình mẫu ví dụ tích cực (có chứa hình ảnh xe) và các hình mẫu không tích cực (không chứa hình ảnh xe hơi) được lựa chọn cẩn thận (đây là phương pháp dựa trên ảnh). Các hình ảnh sau khi được chọn lọc cẩn thận sẽ được quyết định đặc trưng cho từng loại xe bởi thuật t