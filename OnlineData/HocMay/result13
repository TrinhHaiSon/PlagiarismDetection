Sưu Tầm Page 1 By: Dinh Nguyen Chương 1 Giới thiệu chung 1.1 Tổ chức và kiến trúc máy tính 1.2 Cấu trúc và chức năng của máy tính 1.3 Cách tiếp cận của giáo trình Môn học kiến trúc máy tính là môn học khảo sát cấu trúc và chức năng của máy tính. Môn học này giúp học viên hiểu rõ bản chất và những đặc trưng của các hệ thống máy tính hiện đại. Đây là một nhiệm vụ có tính thách đố do: Tính đa dạng của máy tính thể hiện trong giá cả, kích thước, khả năng vận hành & ứng dụng. Máy tính ngày nay gồm rất nhiều chủng loại --- từ các máy đơn chip giá chỉ vài đô la cho đến các siêu máy tính giá hàng triệu đô la --- với kích thước, hiệu suất và ứng dụng thay đổi trên một phạm vi rộng lớn. Sự thay đổi nhanh chóng về công nghệ máy tính, từ kỹ thuật mạch tích hợp dùng để xây dựng nên các thành phần máy tính cho đến việc gia tăng sử dụng những khái niệm về tổ chức song song trong việc kết hợp các thành phần đó. Mặc dù có sự hiện diện của tính đa dạng và tốc độ thay đổi công nghệ trong lĩnh vực máy tính, nhiều khái niệm cơ bản vẫn được áp dụng rộng khắp. Trong giáo trình này, các yếu tố cơ bản về kiến trúc và tổ chức máy tính, mối quan hệ giữa chúng cũng như nhiều bài toán gặp phải trong thiết kế máy tính hiện nay sẽ được thảo luận chi tiết. Chương này sẽ trình bày cách tiếp cận mô tả trong việc khảo sát hệ thống máy tính, qua đó cung cấp cho học viên một bức tranh chung về tổ chức của giáo trình được sử dụng cho môn học kiến trúc máy tính. 1.1 Tổ chức & kiến trúc máy tính Sưu Tầm Page 2 By: Dinh Nguyen Hai thuật ngữ tổ chức máy tính và kiến trúc máy tính là hai thuật ngữ cần được phân biệt khi mô tả một hệ thống máy tính. Kiến trúc máy tính đề cập đến những thuộc tính hệ thống mà lập trình viên có thể quan sát được. Nói cách khác, đó là các thuộc tính có ảnh hưởng trực tiếp đến việc thực thi một chương trình, ví dụ như tập chỉ thị của máy tính, số bit được sử dụng để biểu diễn dữ liệu, cơ chế nhập/xuất, kỹ thuật định địa chỉ bộ nhớ, v.v... Tổ chức máy tính quan tâm đến các đơn vị vận hành và sự kết nối giữa chúng nhằm hiện thực hóa những đặc tả về kiến trúc, chẳng hạn như về tín hiệu điều khiển, giao diện giữa máy tính với các thiết bị ngoại vi, kỹ thuật bộ nhớ được sử dụng, v.v... Để minh họa rõ hơn về hai khái niệm này, chúng ta hãy xét đến phép toán nhân. Việc máy tính có trang bị phép toán này hay không là vấn đề thuộc về kiến trúc máy tính. Trong khi đó, việc cài đặt phép toán thông qua một đơn vị nhân đặc biệt hay qua cơ chế sử dụng lập đi lập lại đơn vị cộng của hệ thống là vấn đề thuộc về tổ chức máy tính. Ở đây sự chọn lựa sử dụng cơ chế nào phụ thuộc vào các yếu tố như tần số sử dụng phép toán, tốc độ tương đối của cả hai cách tiếp cận, giá cả và kích thước vật lý của một đơn vị nhân đặc biệt. Kể từ lúc ngành công nghiệp máy tính ra đời cho đến nay, sự phân biệt giữa kiến trúc và tổ chức máy tính là một yếu tố quan trọng. Nhiều hãng sản xuất máy tính cho ra đời cả một họ máy chỉ khác nhau về tổ chức còn kiến trúc hoàn toàn giống nhau. Kết quả là các kiểu máy trong cùng một họ có giá cả và hiệu suất vận hành khác nhau. Hơn thế nữa, một kiến trúc máy có thể tồn tại qua nhiều năm liền trong khi tổ chức máy dựa trên đó sẽ thay đổi theo bước tiến của công nghệ. Ở đây chúng ta có thể lấy ví dụ trường hợp kiến trúc máy IBM System/370. Kiến trúc này được giới thiệu lần đầu vào năm 1970 với một số kiểu máy khác nhau. Khách hàng với nhu cầu khiêm tốn có thể mua kiểu máy rẻ hơn, chậm hơn và nâng cấp lên kiểu máy đắt tiền hơn, nhanh hơn khi nhu cầu sử dụng tăng lên. Điểm quan trọng trong việc nâng cấp này là khách hàng không phải bỏ đi những phần mềm đang được sử dụng trên máy cũ của họ. Trải qua năm tháng, hãng IBM đã cho ra đời thêm nhiều kiểu máy mới dựa trên công nghệ cải tiến nhằm thay thế những kiểu máy lỗi thời, mang lại cho khách hàng lợi ích về tốc độ và chi phí thấp, trong khi vẫn bảo toàn sự đầu tư của họ về phần mềm nhờ có sự dùng chung một kiến trúc máy cho tất cả kiểu máy trong cùng một họ. Bằng cách tổ chức định hướng người sử dụng như vậy, kiến trúc IBM System/370, qua một vài tinh chỉnh không đáng kể, vẫn tồn tại cho đến ngày nay với vai trò ngọn cờ đầu trong dòng sản phẩm IBM. Trong lớp các máy tính được gọi là máy vi tính, hai yếu tố tổ chức và kiến trúc có mối quan hệ rất gần gũi. Những thay đổi về công nghệ không chỉ ảnh hưởng đến tổ Sưu Tầm Page 3 By: Dinh Nguyen chức mà còn dẫn đến sự ra đời của những kiến trúc mạnh hơn, phong phú hơn. Nói chung thì sự đòi hỏi về tính tương thích từ thế hệ này sang thế hệ khác kém gay gắt hơn đối với những chiếc máy nhỏ này. Do vậy, các quyết định thiết kế có tính kiến trúc và thiết kế có tính tổ chức thường có sự tương tác lẫn nhau. 1.2 Cấu trúc & chức năng của máy tính Máy tính là một hệ thống phức tạp với hàng triệu thành phần điện tử cơ sở. Chìa khóa chính để mô tả máy tính rõ ràng là sự nhận thức về bản chất phân cấp của hầu hết các hệ thống phức tạp. Một hệ thống phân cấp là một tập hợp gồm các hệ thống con có liên quan với nhau, trong đó mỗi hệ thống con lại có tính phân cấp về cấu trúc, cứ thế tiếp tục cho đến cấp thấp nhất chứa những hệ thống con cơ sở. Bản chất phân cấp của một hệ thống phức tạp giữ vai trò chính trong việc thiết kế và mô tả nó. Tại mỗi cấp, hệ thống bao gồm một tập hợp các thành phần con cùng với những mối liên hệ giữa chúng. Ở đây có hai yếu tố được quan tâm đến là cấu trúc và chức năng: Cấu trúc: cách thức các thành phần hệ thống liên hệ với nhau. Chức năng: hoạt động của mỗi thành phần riêng lẻ với tư cách là một phần của cấu trúc. 1.2.1 Chức năng Một cách tổng quát, một máy tính có thể thực hiện bốn chức năng cơ bản sau, như được thể hiện trong hình 1.1: Xử lý dữ liệu: máy tính phải có khả năng xử lý dữ liệu. Dữ liệu có thể có rất nhiều dạng và phạm vi yêu cầu xử lý cũng rất rộng. Tuy nhiên, chúng ta sẽ thấy rằng chỉ có một số phương pháp cơ bản trong xử lý dữ liệu. Sưu Tầm Page 4 By: Dinh Nguyen Hình 1.1 Các chức năng cơ bản của máy tính Lưu trữ dữ liệu: máy tính cũng cần phải có khả năng lưu trữ dữ liệu. Ngay cả khi máy tính đang xử lý dữ liệu, nó vẫn phải lưu trữ tạm thời tại mỗi thời điểm phần dữ liệu đang được xử lý. Do vậy ít nhất chúng ta cần có chức năng lưu trữ ngắn hạn. Tuy nhiên, chức năng lưu trữ dài hạn cũng có tầm quan trọng tương đương, vì dữ liệu cần được lưu trữ trên máy cho những lần cập nhật và tìm kiếm kế tiếp. Di chuyển dữ liệu: máy tính phải có khả năng di chuyển dữ liệu giữa nó và thế giới bên ngoài. Khả năng này được thể hiện thông qua việc di chuyển dữ liệu giữa máy tính với các thiết bị nối kết trực tiếp hay từ xa đến nó. Tùy thuộc vào kiểu kết nối và cự ly di chuyển dữ liệu, chúng ta có tiến trình nhập xuất dữ liệu hay truyền dữ liệu: Tiến trình nhập xuất dữ liệu: thực hiện di chuyển dữ liệu trong cự ly ngắn giữa máy tính và thiết bị nối kết trực tiếp. Tiến trình truyền dữ liệu: thực hiện di chuyển dữ liệu trong cự ly xa giữa máy tính và thiết bị nối kết từ xa. Điều khiển: bên trong hệ thống máy tính, đơn vị điều khiển có nhiệm vụ quản lý các tài nguyên máy tính và điều phối sự vận hành của các thành phần chức năng phù hợp với yêu cầu nhận được từ người sử dụng. Tương ứng với các chức năng tổng quát nói trên, có bốn loại hoạt động có thể xảy ra gồm: Máy tính được dùng như một thiết bị di chuyển dữ liệu, có nhiệm vụ đơn giản là chuyển dữ liệu từ bộ phận ngoại vi hay đường liên lạc này sang bộ phận ngoại vi hay đường liên lạc khác [Hình 1.2 (a)]. Hình 1.2 (a) Máy tính – Thiết bị di chuyển dữ liệu Sưu Tầm Page 5 By: Dinh Nguyen Máy tính được dùng để lưu trữ dữ liệu, với dữ liệu được chuyển từ môi trường ngoài vào lưu trữ trong máy (quá trình đọc dữ liệu) và ngược lại (quá trình ghi dữ liệu) [Hình 1.2 (b)]. Hình 1.2 (b) Máy tính – Thiết bị lưu trữ dữ liệu Máy tính được dùng để xử lý dữ liệu thông qua các thao tác trên dữ liệu lưu trữ [Hình 1.2 (c)] hoặc kết hợp giữa việc lưu trữ và liên lạc với môi trường bên ngoài [Hình 1.2 (d)]. Hình 1.2 (c) Máy tính – Thiết bị xử lý dữ liệu lưu trữ Sưu Tầm Page 6 By: Dinh Nguyen Hình 1.2 (d) Máy tính – Thiết bị xử lý/ trao đổi dữ liệu với môi trường ngoài 1.2.2 Cấu trúc Ở mức đơn giản nhất, máy tính có thể được xem như một thực thể tương tác theo một cách thức nào đó với môi trường bên ngoài. Một cách tổng quát, các mối quan hệ của nó với môi trường bên ngoài có thể phân loại thành các thiết bị ngoại vi hay đường liên lạc. Giáo trình này tập trung khảo sát cấu trúc nội tại của máy tính, như được thể hiện ở mức tổng quát nhất trong hình 1.3. Với hình vẽ này, máy tính có bốn cấu trúc chính: Đơn vị xử lý trung tâm (CPU): điều khiển hoạt động của máy tính và thực hiện các chức năng xử lý dữ liệu. CPU thường được đề cập đến với tên gọi bộ xử lý. Bộ nhớ chính: dùng để lưu trữ dữ liệu. Các thành phần nhập xuất: dùng để di chuyển dữ liệu giữa máy tính và môi trường bên ngoài. Các thành phần nối kết hệ thống: cung cấp cơ chế liên lạc giữa CPU, bộ nhớ chính và các thành phần nhập xuất. Sưu Tầm Page 7 By: Dinh Nguyen Hình 1.3 Cấu trúc tổng quát của máy tính Máy tính có thể có một hoặc nhiều thành phần nói trên, ví dụ như CPU. Trước đây đa phần các máy tính chỉ có một CPU, nhưng gần đây có sự gia tăng sử dụng nhiều CPU trong một hệ thống máy đơn. CPU luôn là đối tượng quan trọng cần được khảo sát vì đây là thành phần phức tạp nhất của hệ thống. Hình 1.4 thể hiện cấu trúc của CPU với các thành phần chính gồm: Đơn vị điều khiển: điều khiển hoạt động của CPU và do đó hoạt động của máy tính. Đơn vị luận lý và số học (ALU): thực hiện các chức năng xử lý dữ liệu của máy tính. Tập thanh ghi: cung cấp nơi lưu trữ bên trong CPU. Thành phần nối kết nội CPU: cơ chế cung cấp khả năng liên lạc giữa đơn vị điều khiển, ALUvà tập thanh ghi. Trong các thành phần con nói trên của CPU, đơn vị điều khiển lại giữ vai trò quan trọng nhất. Sự cài đặt đơn vị này dẫn đến một khái niệm nền tảng trong chế tạo bộ vi xử lý Sưu Tầm Page 8 By: Dinh Nguyen máy tính. Đó là khái niệm vi lập trình. Hình 1.5 mô tả tổ chức bên trong một đơn vị điều khiển với ba thành phần chính gồm: Bộ luận lý lập dãy Bộ giải mã và tập các thanh ghi điều khiển Bộ nhớ điều khiển Ứng với cách tổ chức vừa trình bày của máy tính, chúng ta có thể chia bài toán khảo sát máy tính thành bốn phần như sau: Phần 1: Tổng quan về kiến trúc máy tính Phần 2: Hệ thống máy tính Phần 3: Đơn vị xử lý trung tâm Phần 4: Đơn vị điều khiển Sưu Tầm Page 9 By: Dinh Nguyen Hình 1.4 Bộ xử lý trung tâm của máy tính (CPU) Sưu Tầm Page 10 By: Dinh Nguyen Hình 1.5 Đơn vị điều khiển của CPU 1.3 Cách tiếp cận của giáo trình Trong giáo trình này chúng ta sẽ tìm hiểu hai phần đầu tiên của kiến trúc máy tính với nội dung cụ thể như sau: Phần 1: Tổng quan về kiến trúc máy tính Phần 2: Hệ thống máy tính Nội dung chi tiết của từng phần được liệt kê tiếp sau đây. Phần 1: Tổng quan về kiến trúc máy tính Chương 1 giới thiệu chung về môn học và tổ chức giáo trình. Chương 2 trình bày lịch sử công nghệ máy tính, qua đó giới thiệu những khái niệm cơ bản về tổ chức và kiến trúc máy tính. Sưu Tầm Page 11 By: Dinh Nguyen Phần 2: Hệ thống máy tính Chương 3 khảo sát kỹ thuật đường truyền hệ thống, một trong những cách tiếp cận phổ biến nhất đối với bài toán liên kết các thành phần bên trong máy tính. Chương 4 giới thiệu về tính phân cấp bộ nhớ, sau đó tập trung vào những vấn đề thiết kế liên quan đến bộ nhớ trong. Các chủ đề được thảo luận bao gồm bản chất và tổ chức của bộ nhớ chính bán dẫn, thiết kế cache. Chương 5 tìm hiểu về những tham số hiệu suất và thiết kế khác nhau có liên quan đến bộ nhớ đĩa. Ngoài ra, các lược đồ RAID vốn đang trở nên phổ biến trên thị trường cũng được trình bày trong chương này. chương 2 Lịch sử máy tính 2.1 Máy tính thế hệ thứ nhất (1945 – 1958) 2.2 Máy tính thế hệ thứ hai (1958 – 1964) 2.3 Máy tính thế hệ thứ ba (1964 – 1974) 2.4 Máy tính thế hệ thứ tư (1974 – hiện nay) 2.5 Bài tập và câu hỏi củng cố bài học Máy tính thường được phân loại dựa trên công nghệ phần cứng cơ sở được sử dụng trong quá trình chế tạo. Lịch sử phát triển máy tính có thể chia làm bốn giai đoạn như sau: Giai đoạn 1: từ 1945 đến 1958, với máy tính thế hệ thứ nhất sử dụng công nghệ đèn chân không. Sưu Tầm Page 12 By: Dinh Nguyen Giai đoạn 2: từ 1958 đến 1964, với máy tính thế hệ thứ hai sử dụng công nghệ chất bán dẫn. Giai đoạn 3: từ 1964 đến 1974, với máy tính thế hệ thứ ba sử dụng công nghệ mạch tích hợp. Giai đoạn 4: từ 1974 đến nay, với máy tính thế hệ thứ tư sử dụng công nghệ mạch tích hợp vô cùng lớn/siêu lớn (VLSI/ULSI). Các mục tiếp theo sẽ trình bày chi tiết về từng thế hệ máy tính cùng với công nghệ sử dụng và đại diện tiêu biểu của thế hệ đó. 2.1 MÁY TÍNH THẾ HỆ THỨ NHẤT (1945 – 1958) Máy tính ENIAC Máy ENIAC (Electronic Numerical Integrator And Computer), do John Mauchly và John Presper Eckert (đại học Pensylvania, Mỹ) thiết kế và chế tạo, là chiếc máy số hoá điện tử đa năng đầu tiên trên thế giới. Nguồn gốc Dự án chế tạo máy ENIAC được bắt đầu vào năm 1943. Đây là một nỗ lực nhằm đáp ứng yêu cầu thời chiến của BRL (Ballistics Research Laboratory – Phòng nghiên cứu đạn đạo quân đội Mỹ) trong việc tính toán chính xác và nhanh chóng các bảng số liệu đạn đạo cho từng loại vũ khí mới. Số liệu kỹ thuật ENIAC là một chiếc máy khổng lồ với hơn 18000 bóng đèn chân không, nặng hơn 30 tấn, tiêu thụ một lượng điện năng vào khoảng 140kW và chiếm một diện tích xấp xỉ 1393 m2. Mặc dù vậy, nó làm việc nhanh hơn nhiều so với các loại máy tính điện cơ cùng thời với khả năng thực hiện 5000 phép cộng trong một giây đồng hồ. Điểm khác biệt giữa ENIAC & các máy tính khác ENIAC sử dụng hệ đếm thập phân chứ không phải nhị phân như ở tất cả các máy tính khác. Với ENIAC, các con số được biểu diễn dưới dạng thập phân và việc tính toán cũng được thực hiện trên hệ thập phân. Bộ nhớ của máy gồm 20 "bộ tích lũy", mỗi bộ có khả năng lưu giữ một số thập phân có 10 chữ số. Mỗi chữ số được thể hiện bằng một vòng gồm 10 đèn chân không, trong đó tại mỗi thời điểm, chỉ có một đèn ở trạng thái bật để thể hiện một trong mười chữ số từ 0 đến 9 của hệ thập phân. Việc lập trình trên Sưu Tầm Page 13 By: Dinh Nguyen ENIAC là một công việc vất vả vì phải thực hiện nối dây bằng tay qua việc đóng/mở các công tắc cũng như cắm vào hoặc rút ra các dây cáp điện. Hoạt động thực tế Máy ENIAC bắt đầu hoạt động vào tháng 11/1945 với nhiệm vụ đầu tiên không phải là tính toán đạn đạo (vì chiến tranh thế giới lần thứ hai đã kết thúc) mà để thực hiện các tính toán phức tạp dùng trong việc xác định tính khả thi của bom H. Việc có thể sử dụng máy vào mục đích khác với mục đích chế tạo ban đầu cho thấy tính đa năng của ENIAC. Máy tiếp tục hoạt động dưới sự quản lý của BRL cho đến khi được tháo rời ra vào năm 1955. Với sự ra đời và thành công của máy ENIAC, năm 1946 được xem như năm mở đầu cho kỷ nguyên máy tính điện tử, kết thúc sự nỗ lực nghiên cứu của các nhà khoa học đã kéo dài trong nhiều năm liền trước đó. Máy tính von Neumann Khái niệm chương trình được lưu trữ Như đã đề cập ở trên, việc lập trình trên máy ENIAC là một công việc rất tẻ nhạt và tốn kém nhiều thời gian. Công việc này có lẻ sẽ đơn giản hơn nếu chương trình có thể được biểu diễn dưới dạng thích hợp cho việc lưu trữ trong bộ nhớ cùng với dữ liệu cần xử lý. Khi đó máy tính chỉ cần lấy chỉ thị bằng cách đọc từ bộ nhớ, ngoài ra chương trình có thể được thiết lập hay thay đổi thông qua sự chỉnh sửa các giá trị lưu trong một phần nào đó của bộ nhớ. Ý tưởng này, được biết đến với tên gọi "khái niệm chương trình được lưu trữ", do nhà toán học John von Neumann, một cố vấn của dự án ENIAC, đưa ra ngày 8/11/1945, trong một bản đề xuất về một loại máy tính mới có tên gọi EDVAC (Electronic Discrete Variable Computer). Máy tính này cho phép nhiều thuật toán khác nhau có thể được tiến hành trong máy tính mà không cần phải nối dây lại như máy ENIAC. Máy IAS Tiếp tục với ý tưởng của mình, vào năm 1946, von Neuman cùng các đồng nghiệp bắt tay vào thiết kế một máy tính mới có chương trình được lưu trữ với tên gọi IAS (Institute for Advanced Studies) tại học viện nghiên cứu cao cấp Princeton, Mỹ. Mặc dù mãi đến năm 1952 máy IAS mới được hoàn tất, nó vẫn là mô hình cho tất cả các máy tính đa năng sau này. Cấu trúc tổng quát của máy IAS, như được minh họa trên hình 2.1, gồm có: Sưu Tầm Page 14 By: Dinh Nguyen Một bộ nhớ chính để lưu trữ dữ liệu và chương trình. Một đơn vị số học – luận lý (ALU – Arithmetic and Logic Unit) có khả năng thao tác trên dữ liệu nhị phân. Một đơn vị điều khiển có nhiệm vụ thông dịch các chỉ thị trong bộ nhớ và làm cho chúng được thực thi. Thiết bị nhập/xuất được vận hành bởi đơn vị điều khiển. Hình 2.1 Cấu trúc của máy IAS Hầu hết các máy tính hiện nay đều có chung cấu trúc và chức năng tổng quát như trên. Do vậy chúng còn có tên gọi chung là các máy von Neumann. Do vai trò quan trọng của ma