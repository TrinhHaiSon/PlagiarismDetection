BỘ GIÁO DỤC VÀ ĐÀO TẠO TRƯỜNG ĐẠI HỌC BÁCH KHOA HÀ NỘI ------------------------------------------ LUẬN VĂN THẠC SĨ KHOA HỌC NGÀNH: CÔNG NGHỆ THÔNG TIN PHƯƠNG PHÁP HỌC TĂNG CƯỜNG NGUYỄN THỊ THUẬN HÀ NỘI 2006 N G U Y Ễ N T H Ị TH U Ậ N C Ô N G N G H Ệ T H Ô N G T IN 2004-2006 HÀ NỘI 2006 1 LỜI CẢM ƠN Trong suốt quá trình học tập cũng như quá trình làm luận văn, em đã nhận được sự giúp đỡ của các thầy cô giáo trong bộ môn, đặc biệt là sự chỉ bảo hướng dẫn tận tình của thầy giáo hướng dẫn TS Nguyễn Linh Giang. Với lòng biết ơn sâu sắc, em xin chân thành cảm ơn các thầy cô giáo trong bộ môn đặc biệt là thầy giáo TS Nguyễn Linh Giang đã giúp đỡ để em hoàn thành luận văn thạc sỹ khoa học này. Em cũng xin gửi lời cảm ơn tới ban lãnh đạo cũng như các đồng nghiệp nơi em đang công tác đã tạo điều kiện giúp em có một môi trường nghiên cứu và làm việc tốt. Cuối cùng, em xin gửi lời cảm ơn tới gia đình, bạn bè, những người thân đã luôn động viên, khích lệ và giúp đỡ em trong suốt quá trình học tập và làm luận văn vừa qua. Hà Nội, tháng 10 năm 2006 Học viên Nguyễn Thị Thuận Lớp: Cao học CNTT 2004-2006 2 MỤC LỤC LỜI CẢM ƠN....................................................................................................... 1 MỤC LỤC............................................................................................................. 2 DANH MỤC CÁC KÝ HIỆU, CHỮ VIẾT TẮT .............................................. 4 MỞ ĐẦU ............................................................................................................... 5 CHƯƠNG 1 BÀI TOÁN QUYẾT ĐỊNH MARKOV VÀ PHƯƠNG PHÁP HỌC TĂNG CƯỜNG...........................................................................7 1.1 PHÁT BIỂU BÀI TOÁN..........................................................................7 1.2 CÁC PHẦN TỬ CỦA BÀI TOÁN QUYẾT ĐỊNH MARKOV.............10 1.2.1 Hàm phản hồi...................................................................................15 1.2.2 Hàm giá trị .......................................................................................16 1.3 CẤU TRÚC TOÁN HỌC CỦA BÀI TOÁN QUYẾT ĐỊNH MARKOV 20 1.4 PHƯƠNG PHÁP HỌC TĂNG CƯỜNG................................................26 1.4.1 Ý tưởng chung .................................................................................26 1.4.2 Một số thuật ngữ..............................................................................30 1.4.2.1 Khảo sát và khai thác ...........................................................................30 1.4.2.2 Kỹ thuật ε-greedy, ε-soft và softmax ...................................................30 1.4.2.3 Khái niệm học on-policy và off-policy .................................................32 1.4.3 Phân loại thuật toán học tăng cường ...............................................33 1.4.3.1 Học dựa trên mô hình...........................................................................33 1.4.3.2 Học không có mô hình..........................................................................33 1.4.4 Lịch sử phát triển và các lĩnh vực ứng dụng ...................................35 CHƯƠNG 2 CÁC THUẬT TOÁN HỌC TĂNG CƯỜNG....................... 40 2.1 PHƯƠNG PHÁP QUY HOẠCH ĐỘNG (DP).......................................40 2.2 PHƯƠNG PHÁP MONTE CARLO (MC).............................................41 2.2.1 Phương pháp MC on-policy ............................................................44 2.2.2 Phương pháp MC off-policy............................................................45 2.3 PHƯƠNG PHÁP TEMPORAL DIFFERENCE (TD)............................45 2.3.1 TD(0) ...............................................................................................46 2.3.2 TD(λ) ...............................................................................................47 2.3.3 Q-Learning.......................................................................................48 2.3.4 SARSA ............................................................................................49 3 2.4 SO SÁNH CÁC THUẬT TOÁN HỌC TĂNG CƯỜNG ĐIỂN HÌNH ..50 2.5 MỘT SỐ PHƯƠNG PHÁP TIẾN BỘ KHÁC........................................51 CHƯƠNG 3 THỬ NGHIỆM ....................................................................... 52 3.1 BÀI TOÁN LỰA CHỌN MÔ PHỎNG..................................................52 3.2 PHƯƠNG PHÁP HỌC TĂNG CƯỜNG LỰA CHỌN MÔ PHỎNG ....55 3.2.1 Phương pháp quy hoạch động (DP) ................................................55 3.2.2 Học không có mô hình (Phương pháp Q-Learning)........................58 3.2.3 Học dựa trên mô hình (Phương pháp prioritized sweeping) ...........59 3.3 KỊCH BẢN VÀ KẾT QUẢ THỬ NGHIỆM ..........................................61 3.3.1 Kịch bản 1: Thay đổi kích thước không gian trạng thái..................67 3.3.1.1 Số bước hội tụ.......................................................................................68 3.3.1.2 Thời gian hội tụ ....................................................................................68 3.3.1.3 Phân tích kết quả..................................................................................69 3.3.1.4 Giải pháp cải thiện...............................................................................70 3.3.1.5 Kết luận ................................................................................................70 3.3.2 Kịch bản 2: Thay đổi hệ số học.......................................................70 3.3.2.1 Phân rã hệ số học theo số đoạn lặp .....................................................71 3.3.2.2 Mối quan hệ giữa giá trị chiến lược và hệ số học...............................71 3.3.2.3 Phân tích kết quả..................................................................................73 3.3.2.4 Giải pháp cải thiện...............................................................................73 3.3.2.5 Kết luận ................................................................................................74 3.3.3 Kịch bản 3: Thay đổi số đoạn lặp....................................................74 3.3.3.1 Mối quan hệ giữa giá trị chiến lược và số đoạn lặp ............................74 3.3.3.2 Phân tích đánh giá kết quả...................................................................76 3.3.4 Kịch bản 4: Thay đổi chiến lược lựa chọn ......................................76 3.3.4.1 Mối quan hệ giữa giá trị chiến lược và tham số chiến lược ................76 3.3.4.2 Phân tích đánh giá kết quả...................................................................77 ĐÁNH GIÁ KẾT LUẬN.................................................................................... 78 TÀI LIỆU THAM KHẢO ................................................................................. 79 TÓM TẮT LUẬN VĂN..................................................................................... 80 4 DANH MỤC CÁC KÝ HIỆU, CHỮ VIẾT TẮT Thuật ngữ Viết tắt Học tăng cường (Reinforcement Learning) RL Phương pháp lập trình động (Dynamic Programming) DP Phương pháp Monte Carlo MC Phương pháp Temporal Difference TD 5 MỞ ĐẦU  Tính cấp thiết của đề tài Xã hội ngày càng hiện đại, các kỹ thuật công nghệ ngày càng phát triển, đi cùng với nó là các nghiên cứu phát triển không ngừng về lĩnh vực trí tuệ nhân tạo và học máy, cho ra đời các hệ thống máy móc thông minh ứng dụng rộng rãi trong hầu hết các lĩnh vực đời sống như máy truy tìm dữ liệu, chẩn đoán y khoa, phát hiện thẻ tín dụng giả, phân tích thị trường chứng khoán, phân loại chuỗi DNA, nhận dạng tiếng nói và chữ viết, … đặc biệt là trong lĩnh vực điều khiển. Các phương pháp tự đào tạo (học) đã được đưa ra từ rất lâu để chỉ khả năng các hệ thống thông minh trong quá trình hoạt động tự tích luỹ, phân tích các thông tin thu được từ đó tự nâng cao khả năng của bản thân, đây chính là mục đích quan trọng trong lỹ thuyết quyết định cũng như trong các bài toán tự động hoá và điều khiển tối ưu. Chúng ta có nhiều loại thuật toán học như học có giám sát, học không có giám sát, học tăng cường, mỗi loại thuật toán thích ứng với từng loại bài toán cụ thể. Trong phạm vi đề tài này, chúng ta sẽ nghiên cứu và tìm hiểu các vấn đề liên quan đến phương pháp học tăng cường. Đây là một thuật toán học có khả năng giải quyết được những bài toán thực tế khá phức tạp trong đó có sự tương tác giữ hệ thống và môi trường. Với những tình huống môi trường không chỉ đứng yên, cố định mà thay đổi phức tạp thì các phương pháp học truyền thống không còn đáp ứng được mà phải sử dụng phương pháp học tăng cường. Những bài toán với môi trường thay đổi trong thực tế là không nhỏ và ứng dụng nhiều trong các lĩnh vực quan trọng.  Mục đích 6 Qua quá trình làm luận văn sẽ tổng hợp và nắm vững các kiến thức về phương pháp học tăng cường nói chung. Hiểu rõ ý tưởng, cơ chế hoạt động các thuật toán học tăng cường và ứng dụng trong các bài toán điển hình cụ thể. Đồng thời cũng thực hiện mô phỏng bài toán thử nghiệm, đo đạc thống kê và đánh giá kết quả thử nghiệm về các thuật toán RL.  Giới hạn vấn đề Do những hạn chế về điều kiện và thời gian thực hiện, đề tài nghiên cứu mới chỉ ở mức lý thuyết và cài đặt thử nghiệm, chưa được ứng dụng vào thực tiễn.  Hướng phát triển Trong thời gian tới, sẽ cố gắng ứng dụng các kiến thức về phương pháp học tăng cường, xây dựng bài toán thực tiễn cụ thể và ứng dụng rộng rãi.  Bố cục của luận văn Luận văn gồm 3 chương với những nội dung chính như sau: Chương 1: Trình bày lý thuyết tổng quan về phương pháp học tăng cường, mô hình bài toán quyết định Markov, bên cạnh đó cũng giới thiệu sơ lược về sự ra đời, cũng như lịch sử phát triển của phương pháp học tăng cường, các lĩnh vực ứng dụng trong thực tiễn. Chương 2: Trình bày chi tiết về đặc điểm, các bước thực hiện của từng loại giải thuật học tăng cường đã và đang được sử dụng hiện nay. Chương 3: Trình bày về bài toán lựa chọn thử nghiệm, giới thiệu lại sơ qua về loại thuật toán học tăng cường lựa chọn áp dụng trong bài toán thử nghiệm. Các kịch bản thử nghiệm và các kết quả thu được. Trên cơ sở đó, kết luận đánh giá và đưa ra giải pháp cải tiến. 7 Chương 1 BÀI TOÁN QUYẾT ĐỊNH MARKOV VÀ PHƯƠNG PHÁP HỌC TĂNG CƯỜNG Phương pháp học tăng cường là một phương pháp phổ biến để giải các bài toán quyết định Markov. Bài toán quyết định Markov có rất nhiều ứng dụng trong các lĩnh vực kỹ thuật như lý thuyết quyết định, quy hoạch toán học, điều khiển tối ưu, ... Trong phần này, chúng ta sẽ trình bày về quá trình quyết định Markov trong đó tập trung vào các khái niệm của quá trình Markov có số bước vô hạn và có số bước hữu hạn. 1.1 PHÁT BIỂU BÀI TOÁN Bài toán quyết định Markov là bài toán học từ các tác động để đạt được mục đích. Người học và người ra quyết định được gọi là tác tử. Tất cả những gì mà chúng tương tác với, bao gồm mọi thứ bên ngoài tác tử được gọi là môi trường. Các tác động thực hiện một cách liên tục, tác tử lựa chọn các hành động, môi trường đáp ứng lại các hành động đó và chuyển từ trạng thái hiện thời sang trạng thái mới. Môi trường cũng đem lại các mục tiêu, các giá trị bằng số mà tác tử cố gắng cực đại hoá qua thời gian. Một đặc tả hoàn thiện về môi trường được coi là một “nhiệm vụ”, một thực thể của bài toán quyết định Markov. Tóm lại, bài toán quyết định Markov liên quan đến lớp bài toán trong đó một tác tử rút ra kết luận trong khi phân tích một chuỗi các hành động của nó cùng với tín hiệu vô hướng được đưa ra bởi môi trường. Trong khái niệm chung này có thể thấy hai đặc tính quan trọng: • Tác tử tương tác với môi trường và cặp “Tác tử + Môi trường” tạo thành một hệ thống động. 8 • Tín hiệu tăng cường, được nhận biết dựa vào mục tiêu, cho phép tác tử thay đổi hành vi của nó. Lược đồ tương tác tác tử-môi trường như sau: Hình 1.1: Mô hình tương tác giữa tác tử và môi trường Trong lược đồ trên, tác tử và môi trường tác động lẫn nhau tại mỗi bước trong chuỗi các bước thời gian rời rạc, t = 0, 1, 2, 3, …Tại mỗi bước thời gian t, tác tử nhận một số biểu diễn về trạng thái của môi trường, st∈S, với S là tập các trạng thái có thể, và trên đó lựa chọn một hành động at∈A(st), với A(st) là tập các hành động có hiệu lực trong trạng thái st. Mỗi bước thời gian tiếp theo, tác tử nhận một giá trị tăng cường rt+1∈R và tự nó tìm ra một trạng thái mới st+1. Tại mỗi bước tác tử thực hiện ánh xạ từ các trạng thái đến các hành động có thể lựa chọn. Phép ánh xạ này được gọi là chiến lược của tác tử, kí hiệu là πt với πt(s,a) là xác suất thực hiện hành động at=a khi st=s. Như vậy, bài toán quyết định Markov thực chất có thể được phát biểu như sau: Biết - Tập các trạng thái: S - Tập các hành động có thể: A - Tập các tín hiệu tăng cường (mục tiêu). Bài toán Tìm π:S→A sao cho R lớn nhất 9 Với mô hình bài toán quyết định Markov như trên, chúng ta có thể xem xét qua một số ví dụ quen thuộc. Ví dụ 1: Máy bán hàng tự động - Trạng thái: cấu hình các khe. - Hành động: thời gian dừng lại. - Mục tiêu: kiếm được nhiều tiền. - Bài toán: tìm π:S→A sao cho R lớn nhất. Ví dụ 2: Tic-Tac-Toe Đây là một trò chơi quen thuộc của giới trẻ. Hai người chơi thực hiện chơi trên một bảng kích thước 3x3. Một người ghi kí hiệu X và một người ghi kí hiệu O, đến tận khi có người thắng nhờ ghi 3 dấu trên cùng một hàng dọc hoặc hàng ngang hoặc hàng chéo, như người ghi dấu X trong hình vẽ: Nếu bảng bị lấp đầy mà không người chơi nào ghi được 3 dấu trong cùng một hàng thì trận đấu sẽ hoà. Bài toán tic-tac-toe được tiếp cận sử dụng RL như sau: - Trạng thái: bảng 3x3. - Hành động: phép di chuyển tiếp theo. - Mục tiêu: 1 nếu thắng, -1 nếu thua, 0 nếu hoà. - Bài toán: tìm π:S→A sao cho R lớn nhất. Ví dụ 3:Robot di động - Trạng thái: vị trí của Robot và của người. - Hành động: sự di chuyển. - Mục tiêu: số các bước đối mặt thành công. 10 - Bài toán: tìm π:S→A sao cho R lớn nhất. Để hiểu rõ ràng về các bài toán trong thực tế, ở đây chúng ta xét ví dụ một cuộc đối thoại về mối quan hệ giữa tác tử và môi trường như sau: Môi trường: Bạn đang ở trạng thái 65. Bạn có 4 hành động để lựa chọn. Tác tử: Tôi lựa chọn hành động 2. Môi trường: Bạn nhận được một giá trị tăng cường là 7 đơn vị. Hiện tại bạn đang ở trạng thái 15. Bạn có 2 hành động để lựa chọn. Tác tử: Tôi lựa chọn hành động 1. Môi trường: Bạn nhận được một giá trị tăng cường là -4 đơn vị. Hiện tại bạn đang ở trạng thái 65. Bạn có 4 hành động để lựa chọn. Tác tử: Tôi lựa chọn hành động 2. Môi trường: Bạn nhận được một giá trị tăng cường là 5 đơn vị. Hiện tại bạn đang ở trạng thái 44. Bạn có 5 hành động để lựa chọn. 1.2 CÁC PHẦN TỬ CỦA BÀI TOÁN QUYẾT ĐỊNH MARKOV Dựa vào tác tử và môi trường, chúng ta có thể định nghĩa 4 phần tử con của một bài toán quyết định Markov: chiến lược (policy), hàm phản hồi (reward function), hàm giá trị (value function), và không bắt buộc, một mô hình về môi trường. Chiến lược định nghĩa cách thức tác tử học từ hành động tại thời điểm đưa ra. Chiến lược là một ánh xạ từ tập các trạng thái của môi trường đến tập các hành động được thực hiện khi môi trường ở trong các trạng thái đó. Nó tương ứng với 11 tập các luật nhân quả trong lĩnh vực tâm lí học. Trong một số trường hợp, chiến lược có thể là một hàm đơn giản hoặc một bảng tra cứu, trong những trường hợp khác, nó có thể liên quan đến các tính toán mở rộng ví dụ như một tiến trình tìm kiếm. Chiến lược là nhân của một tác tử với nhận thức rằng một mình nó đủ quyết định hành động. Hàm phản hồi định nghĩa mục tiêu trong bài toán quyết định Markov. Nó ánh xạ mỗi trạng thái quan sát được (hoặc một cặp hành động-trạng thái) của môi trường với một giá trị phản hồi để chỉ ra mong muốn thực chất về trạng thái đó. Mục đích duy nhất của tác tử là cực đại hoá tổng giá trị phản hồi nó nhận được trong suốt thời gian chạy. Hàm phản hồi định nghĩa sự kiện nào là tốt hay xấu cho tác tử. Trong một hệ thống thuộc lĩnh vực sinh vật học, không phù hợp để định nghĩa các giá trị phản hồi với niềm vui và sự đau đớn. Chúng là các đặc tính tức thì và được định nghĩa là các vấn đề mà tác tử cần đối mặt. Như thế, hàm phản hồi cần phải có khả năng thay đổi bởi tác tử. Tuy nhiên, nó có thể phục vụ dưới dạng một yếu tố cơ bản để thay đổi chiến lược. Ví dụ, nếu hành động lựa chọn bởi chiến lược được theo sau bởi một hàm phản hồi thấp, thì chiến lược có thể được thay đổi để lựa chọn hành động khác thay thế trong tương lai. Trong khi một hàm phản hồi chỉ ra cái gì là tốt cho một ý thức tức thì, một hàm giá trị sẽ đặc tả cái gì là tốt trong suốt một giai đoạn thời gian. Nói cách khác, giá trị của một trạng thái là tổng số các hàm phản hồi một tác tử có thể kỳ vọng để tích luỹ trong tương lai, bắt đầu từ trạng thái đó. Trong khi các giá trị phản hồi quyết định mong muốn thực chất tức thì về các trạng thái môi trường, thì các hàm giá trị chỉ ra mong muốn trong cả quá trình về các trạng thái sau khi đưa vào bản miêu tả các trạng thái tiếp theo, và các mục tiêu hiệu quả trong các trạng thái đó. Ví dụ, một trạng thái có thể thường xuyên mang lại một hàm phản 12 hồi tức thì thấp, nhưng vẫn có một hàm giá trị cao, vì nó thường được theo sau bởi các trạng thái khác mà mang lại các giá trị phản hồi cao, hoặc ngược lại. Để tạo ra các mô hình tương tự con người, các giá trị phản hồi giống như là sự hài lòng (khi hàm phản hồi có giá trị lớn) và hình phạt (khi hàm phản hồi có giá trị thấp), trong khi các hàm giá trị tương ứng với một sự phán đoán tinh tế hơn và nhìn xa trông rộng hơn về việc chúng ta hài lòng hay không hài lòng như thế nào khi môi trường ở trong một trạng thái riêng biệt. Biểu diễn theo cách này, chúng ta kỳ vọng rằng các hàm giá trị rõ ràng là một ý tưởng khuôn mẫu thân thiện và căn bản. Các hàm phản hồi là trong một ngữ cảnh chính, trong khi các hàm giá trị, như là các tiên đoán của các giá trị phản hồi, là nhân tố thứ hai. Không có các giá trị phản hồi thì sẽ không có các hàm giá trị. Mục đích duy nhất của việc ước lượng các hàm giá trị là để đạt được các giá trị phản hồi lớn hơn. Tuy nhiên, chính các hàm giá trị là đối tượng mà chúng ta đề cập đến nhiều nhất khi ra quyết định và đánh giá quyết định. Việc lựa chọn quyết định dựa trên sự phán đoán về hàm giá trị. Chúng ta tìm kiếm các hành động mà đem lại các trạng thái với giá trị lớn nhất, chứ không phải là các phản hồi lớn nhất, bởi vì các hành động này chứa số lượng phản hồi lớn nhất cho chúng ta trong cả giai đoạn. Trong ra quyết định và lập kế hoạch, con số được kế thừa được gọi là “giá trị” là một đối tượng mà chúng ta quan tâm nhiều nhất. Thật không may, việc xác định giá trị khó hơn nhiều so với xác định giá trị phản hồi. Các giá trị phản hồi về cơ bản được đưa ra trực tiếp bởi môi trường, nhưng các hàm giá trị cần phải được ước lượng và ước lượng lại từ chuỗi các quan sát tác tử có được qua toàn bộ thời gian sống của nó. Thực tế, thành phần quan trọng nhất của tất cả các thuật toán học tăng cường là một phương pháp để ước lượng các hàm giá trị một cách hiệu quả nhất. Vai trò 13 trung tâm của phép ước lượng hàm giá trị có thể xem là điều quan trọng nhất mà chúng ta học về phương pháp học tăng cường trong suốt các thập kỷ gần đây. Mặc dù hầu hết các phương pháp học tăng cường được xem xét tuân theo cấu trúc xung quanh việc ước lượng các hàm giá trị, tuy nhiên đây cũng không phải là nhân tố bắt buộc để giải quyết được các bài toán quyết định Markov. Ví dụ, có thể sử dụng các phương pháp tìm kiếm như các thuật toán phát sinh, lập trình phát sinh, huấn luyện tái tạo và các phương pháp tối ưu hoá chức năng khác được sử dụng để giải quyết các bài toán quyết định Markov. Các phương p