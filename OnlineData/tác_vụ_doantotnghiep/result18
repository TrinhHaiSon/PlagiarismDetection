ĐỒ ÁN TỐT NGHIỆP ĐIỆN TỬ MÁY KHOAN MẠCH IN, thuyết minh ĐỒ ÁN TỐT NGHIỆP ĐIỆN TỬ SCADA, bộ điều khiển lập trình MÁY KHOAN MẠCH IN CHƯƠNG MỞ ĐẦU
I _ KHÁI QUÁT VẤN ĐỀ
Hệ thống điều khiển máy khoan bằng máy tính điện tử là một tập hợp các thiết bị và phụ kiện liên quan. Để nắm được hết các nguyên lý hoạt động và cấu tạo của chúng rõ ràng là một vệc không đơn giản. Thậm chí ngay cả tên gọi của một số bộ phận trong hệ thống cũng gây phiền hà cho người sử dụng. Trước những tiến bộ như vũ bảo của ngành công nghiệp ngày nay và nhu cầu ứng dụng máy tính vào mọi lĩnh vực, hệ thống điều khiển tự động ngày càng được phát triển một cách hoàn hảo và có độ chính xác cao.
Hoạt động cơ bản của hệ thống điều khiển máy khoan bằng máy tính được thực hiện cũng giống như các loại giao tiếp khác. Dữ liệu được chứa trong bộ nhớ của máy tính, sau đó được xuất ra qua cổng giao tiếp nối tiếp đưa đến máy khoan để điều khiển động cơ định vị đúng vị trí cần khoan, và cứ thế hết vị trí này đến vị trí khác đến khi nào mà máy tính gởi lệnh dừng thì động cơ không hoạt động nữa. Khi ấy hệ thống khoan mạch in hoàn thành.
II_ GIỚI HẠN ĐỀ TÀI
Do thời gian nghiên cứu và thực hiện đề tài chỉ giới hạn trong vòng 6 tuần, với vốn kiến thức và việc tìm hiểu về hệ thống điều khiển và cơ cấu cấu tạo, cũng như các bộ phận chi tiết trong hệ thống điều khiển còn hạn chế, luận văn này chỉ thực hiện trong phạm vi ứng dụng phần mềm Pal-El để khoan mạch in bao gồm các phần sau:
Phần I : Cơ sở lý thuyết về giao tiếp
Giao tiếp với máy tính
Giới thiệu về chuẩn RS-232
Phần II : Các khái niệm về máy điều khiển theo chương trình số
Đại cương về điều khiển theo chương trình số
Truyền động bằng động cơ bước
Phần III : Phần mềm
Ứng dụng phần mềm PAL-El để khoan mạch i

III _ MỤC TIÊU NGHIÊN CỨU
Dựa trên tài liệu và thiết bị điều khiển, đặt biệt máy khoan có sẵn, cũng như phần mền điều khiển được dịch từ tài liệu PAL_EP ….. để viết một chương trình ứng dụng thực tế đơn giản nhằm góp phần phong phú thêm cho việc hiểu biết về lĩnh vực này đồng thời có thể mở rộng và định hướng cho những đề tài sau
CHƯƠNG I
GIAO TIẾP MÁY TÍNH
I _ CÁC VẤN ĐỀ CƠ BẢN VỀ MÁY TÍNH
Trải qua một thời gian dài từ phát minh đầu tiên ra máy tính cho đến nay, máy tính đã không ngừng nâng cao và phát triển qua nhiều thế hệ. Tuy nhiên hầu hết máy tính đang phổ biến hiện nay đều có nguồn gốc xuất phát từ họ PC (Personal Computer). Đầu tiên là kiểu máy PCXT do hãng IBM chế tạo với bộ xử lý (CPU) 8088 của hãng Intel. Đây là hệ thống xử lý dữ liệu 16 bit nhưng dùng bus dữ liệu 8 bit.
Tiếp theo đó là máy AT ra đời với bộ xử lý 80286 có tính năng hơn hẳn chip 8088 của máy PC XT. Nó có khả năng tạo ra bộ nhớ ảo, đa nhiệm vụ, tốc độ nhanh, độ tin cậy cao và dùng bus dữ liệu 16 bit. Đa nhiệm (Multitasking) là khả năng thực hiện một lúc nhiều nhiệm vụ:
Vừa in một tài liệu
Vừa tính toán một phép tính
Công việc này thực hiện được nhờ hoán chuyển nhanh theo sự theo dõi của CPU đến các chương trình mà nó đang nắm quyền điều khiển .Việc này được thực hiện ngay bên trong CPU cộng với một vài giúp đỡ của hệ điều hành.Bộ nhớ ảo (Virtull Memory) cho phép máy tính làm việc với một bộ nhớ dường như lớn hơn nhiều so với bộ nhớ vật lý hiện có: Công việc này thực hiện được nhờ một phần mềm và sự thiết kế phần cứng cực kỳ tinh xảo.
Ngày nay các máy AT 386, 486, Pentium dùng chip CPU lần lượt là 80386, 80486, P5 là kết quả của trình độ kỹ thuật và công nghệ hiện đại. Chương trình một bộ nhớ lớn hơn tổ tiên là : 8088 hay 80286 cùng với nhiều chức năng mới, thêm nữa là tốc độ vi xử lý không ngừng được nâng cao độ rộng của data bus cũng mở rộng lên 32bit rồi 64 bit với Pentium.
II _ CÁC PHƯƠNG PHÁP ĐIỀU KHIỂN VÀO RA:
Vào ra điều khiển bằng chương trình:
Thiết bị ngoai vi điều ghép với Bus hệ thống vi xử lý thông qua các phần thích ứng về công nghệ chế tạo và logic. Thích ứng về công nghệ chế tạo là điều chỉnh mức công nghệ sản xuất thiết bị ngoại vi và công nghệ sản xuất của mạch trong hệ vi xử lý. Thích ứng về Logic là nhiệm vụ tạo tín hiệu điều khiển ngoại vi tín hiệu trên bus hệ thống.
Trong hệ vi xử lý một vùng nhớ dùng làm nơi chứa địa chỉ cổng vào ra và CPU xuất hoặc nhập dữ liệu từ các cổng vào ra này các lệnh xuất nhập In/Out Lúc này cổng vào ra được xem như thanh ghi ngoài, chúng được viết vào hoặc đọc ra như ô nhớ Ram qua hai lệnh trên. Để phân biệt hướng xuất hoặc nhập dữ liệu từ cổng vào ra CPU phát ra tín hiệu điều khiển đọc hoặc viết. Để phân biệt vùng nhớ với thiết bị vào ra CPU phát ra tín hiệu điều khiển IO/M. Khi có các lệnh này thì các lệnh In/Out mới có tác dụng.
Ngoài các lệnh qui chiếu bộ nhớ, cũng như khả năng trao đổi dữ liệu giữa thiết bị ngoại vi và hệ vi xử lý. Lúc đó vào ra được gán như một địa chỉ ô nhớ của bộ nhớ. Các thanh ghi liên quan tới cổng vào ra được xem như ngăn nhớ. Khi bộ vi xử lý gọi địa chỉ và xung điều khiển đọc hay viết bộ nhớ không cần xác định nơi gởi là bộ nhớ hay thiết bị vào ra. Nó chỉ hỏi nơi gởi dữ liệu vào trong khoảng thời gian cho phép. Bộ logic bên ngoài sẽ giải mã địa chỉ kết hợp với xung MR, MW, để chọn thiết bị mà không phân biệt ngăn nhớ hay thiết bị vào ra.

Vào ra điều khiển bằng ngắt:
Với phương pháp điều khiển vào ra bằng chương trình, CPU phải liên tục kiểm tra trạng thái của thiết bị ngoại vi đến khi sẵn sàng, đó là sự lãng phí thời gian của CPU và chương trình dài và phức tạp. Khi bộ vi xử lý có nhiều thiết bị ngoại vi CPU không đáp ứng yêu cầu của chúng. Có thể đáp ứng yêu cầu ngoại vi nhanh chóng và không theo trình tự như định trước nhờ cơ cấu ngắt CPU.
Nhờ tính chất đáp ứng tức thời của vi xử lý khi có yêu cầu ngắt từ thiết bị ngoại vi do đó các ngắt thường được dùng ở những trường hợp yêu cầu đap ứng nhanh, thời gian trả lời ngắn, thực hiện ở bất kỳ thời điểm nào. Khi đó CPU phải chuyển đến chương trình con, yêu cầu ngắt ở cuối bất kỳ lệnh nào trong chương trình chính. Các chương trình con phục vụ ngắt có thể lưu trữ nội dung các thanh ghi và khôi phục lại khi thực hiện xong chương trình phục vụ ngắt và trước khi trở lại chương trình chính.
Giao tiếp với maý tính là trao đổi dữ kiện giữa một máy tính với một hay nhiều thiết bị ngoại vi.
Theo tiêu chuẩn sản xuất, máy tính giao tiếp với người sử dụng bằng hai thiết bị:
Bàn phím để nhập dữ liệu
Màn hình để hiển thị
Ngoài ra nhà sản xuất cho ta nhiều cách giao tiếp khác thông qua các port như là các ngõ giao tiếp:
Giao tiếp qua port com (nối tiếp)
Giao tiếp qua port Parallel(song song)
Tùy theo trường hợp ứng dụng cụ thể mà chọn cách giao tiếp thích hợp.
III _ PHƯƠNG PHÁP GIAO TIẾP
Giao tiếp với máy tính thông qua slot card:
Bên trong máy tính, ngoài những khe cắm dùng cho card vào - ra, card màn hình, vẫn còn những rãnh cắm để trống. Để giao tiếp với máy tính, ta có thể thiết kế card mở rộng để gắn vào khe cắm mở rộng này. Ở máy tính PC/XT rãnh cắm chỉ có 1 loại với độ rộng 8 bit và tuân theo tiêu chuẩn ISA (Industry Standard Architecture). Rãnh cắm theo tiêu chuẩn IS có 62 đường tín hiệu, qua các đường tín hiệu này máy tính có thể giao tiếp dễ dàng với thiết bị bên ngoài thông qua card mở rộng.
Trên rãnh cắm mở rộng, ngoài 20 đường địa chỉ, 8 đường dữ liệu, còn có một số đường điều khiển như: , , IOW, AEN, CLK, ... Do đó card giao tiếp với máy tính qua slot card đơn giản, số bit có thể tăng dễ dàng, giảm được nhiều linh kiện, tốc độ truyền dữ liệu nhanh (truyền song song). Tuy nhiên, do khe cắm nằm bên trong máy tính nên khi muốn gắn card giao tiếp vào thì phải mở nắp ra, điều này gây bất tiện cho người sử dụng.

Giao tiếp qua Serial Port (Port COM) :
IBM PC cung cấp 2 cổng nối tiếp: COM1 và COM2. Các cổng này giao tiếp theo tiêu chuẩn RS232. Chúng có thể được nối với một Modem để dùng cho mạng điện thoại, hay nối trực tiếp với một máy tính khác. Dữ liệu được truyền qua cổng này theo cách nối tiếp, nghĩa là dữ liệu được gởi đi nối tiếp nhau trên 1 đường dây. Do các dữ liệu được truyền đi từng bit một nên tốc độ truyền chậm, các tốc độ truyền có thể là 300, 600, 1200, 2400, 4800bps, 9600bps, chiều dài dữ liệu có thể là 5, 6, 7 hoặc 8 bit và kết hợp với các bit Start, Stop, Parity tạo thành một khung (frame). Ngoài ra cổng này còn có các điều khiển thu (Receive), phát (Trans), kiểm tra. Cách giao tiếp này cho phép khoảng cách truyền dữ liệu xa, tuy nhiên tốc độ truyền rất chậm tốc độ tối đa là 20kbps.

Giao tiếp qua cổng PRINT (Cổng máy in):
IBM PC cho phép sử dụng đến 3 cổng song song có tên là LP1, LP2 và LP3. Kiểu giao tiếp song song được dùng để truyền dữ liệu giữa máy tính và máy in. Khác với cách giao tiếp qua Port Com, ở cách giao tiếp này dữ liệu được truyền song song cùng một lúc 8 bit. Vì thế nó có thể đạt tốc độ cao. Connector của Port này có 25 chân bao gồm 8 chân dữ liệu và các đường tín hiệu bắt tay (Handshaking ). Tất cả các đường Data và tín hiệu điều khiển đều ở mức logic hoàn toàn tương thích với mức TTL. Hơn nữa, người lập trình có thể điều khiển cho phép hoặc không cho phép các tín hiệu tạo Interrupt từ ngõ vào nên việc giao tiếp đơn giản và dễ dàng. Tuy nhiên, giao tiếp với mức logic TTL nên khoảng cách truyền bị hạn chế so với cách truyền qua Port Com, đồng thời cáp truyền cũng phức tạp hơn. Đó là nhược điểm của cách giao tiếp này.
CHƯƠNG II
GIỚI THIỆU CHUẨN RS-232C
Vào năm 1960, cùng với sự phát triển mạnh của các thiết bị đầu cuối máy tính chia sẻ thời gian, các Modem đã được tung ra ngày càng nhiều nhằm đảm bảo cho các thiết bị đầu cuối có thể dùng các đường điện thoại để thông tin giữa các máy tính với nhau ở những khoảng cách xa. Modem và các thiêt bị được dùng để gửi số liệu nối tiếp thường được gọi là thiết bị thông tin số liệu DCE (Datommunication Equipment). Các thiết bị đầu cuối hoặc máy tính đang gửi hay nhận số liệu được gọi là các thiết bị đầu số liệu DTE (Data Terminal Equipment). Nhằm đáp ứng với nhu cầu về tín hiệu và các chuẩn bắt tay (handshake standards) giữa DTE và DCE, hiệp hội kỹ thuật điện tử EIA đã đưa ra chuẩn RS-232C. Chuẩn này mô tả chức năng 25 chân tín hiệu và bắt tay cho việc chuyển dữ liệu nối tiếp. Nó cũng mô tả các mức điện áp, trở kháng, tốc độ truyền cực đại và điện dung cực đại cho các đường tín hiệu này.
RS-232 ấn định 25 chân tín hiệu, và quy định các đầu nối DTE phải là male (đực) và các đầu nối DCE phải là female (cái). Một loại đầu nối đặc biệt không được cho, nhưng thường dùng nhiều nhất là đầu nối mele DB-25P (hình 2-1). Ngoài ra, đối với nhiều hệ thống còn dùng loại 9 chân như loại DE-9P mele (hình 2-2)
Được EIA đưa vào năm 1969 để truyền dữ liệu nối tiếp và tín hiệu điều khiển giữa Modem và thiết bị đầu cuối (hoặc máy tính) với tốc độ truyền tối đa là 20kbps ở cự ly khoảng 15m. đây là một dạng giao tiếp loại TTL + bộ kích đường dây không cân bằng.
Việc mô tả chuẩn này được chia làm ba phần: Các đặc điểm kỹ thuật về điện, mô tả các đường dữ liệu điều khiển và sử dụng bộ kết nối chân ra.
I _ ĐẶC ĐIỂM KỸ THUẬT VỀ ĐIỆN CỦA RS232C

IN NUMBERS FOR 9 PINS PIN NUMBERS FOR 25 PINS COMMON NAME RS232C NAME SIGNAL DIRECTION ON DCE 3 2 7 8 1 2 3 4 5 TxD RxD RTS CTS AA BA BB CA CB - IN OUT IN OUT 6 5 1 6 7 8 9 10 DSR GND CD CC AB CF - - OUT - OUT - - 11 12 13 14 15 SCF SCB SBA ĐB - OUT OUT IN OUT 4 16 17 18 19 20 SBB SCA CD OUT OUT - IN IN 9 21 22 23 24 25 CG CE CH/CI DA OUT OUT IN/OUT IN -
Qui định về chân của RS232C
Mức điện áp logic của RS-232C là khoảng điện áp giữa +15V và –15V. Các đường dữ liệu sử dụng mức logic âm: logic 1 có điện thế giữa –5V và –15V, logic 0 có điện thế giữa +5V và +15V. tuy nhiên các đường điền khiển (ngoại trừ đường TDATA và RDATA) sử dụng logic dương: gía trị TRUE = +5V đến +15V và FALSE =-5V đến –15.
Ở chuẩn giao tiếp này, giữa ngõ ra bộ kích phát và ngõ vào bộ thu có mức nhiễu được giới hạn là 2V. Do vậy ngưỡng lớn nhất của ngõ vào là ±3V trái lại mức ± 5V là ngưỡng nhỏ nhất với ngõ ra. Ngõ ra bộ kích phát khi không tải có điện áp là ± 25V.
Các đặc điểm về điện khác bao gồm
RL (điện trở tải) được nhìn từ bộ kích phát có giá trị từ 3 ÷ 7k.
CL (điện dung tải) được nhìn từ bộ kích phát không được vượt quá 2500pF.
Để ngăn cản sự dao động quá mức, tốc độ thay đổi (Slew rate ) của điện áp không được vượt qúa 30V/µs.
Đối với các đường điều khiển, thời gian chuyển của tín hiệu (từ TRUE sang FALSE, hoặc từ FALSE sang TRUE ) không được vượt qúa 1ms. Đối với các đường dữ liệu, thời gian chuyển (từ 1 sang 0 hoặc từ 0 sang 1) phải không vượt qúa 4% thời gian của 1 bit hoặc 1ms.

II _ CÁC ĐƯỜNG DỮ LIỆU VÀ ĐIỀU KHIỂN CỦA RS232
TxD: Dữ liệu được truyền đi từ Modem trên mạng điện thoại. RxD: Dữ liệu được thu bởi Modem trên mạng điện thoại.
Các đường báo thiết bị sẵn sàng:
DSR : Để báo rằng Modem đã sẵn sàng. DTR : Để báo rằng thiết bị đầu cuối đã sẵn sàng Các đường bắt tay bán song công. RTS : Để báo rằng thiết bị đầu cuối yêu cầu phát dữ liệu. CTS : Modem đáp ứng nhu cầu cần gửi dữ liệu của thiết bị đầu cuối cho thiết bị đầu cuối có thể sử dụng kênh truyền dữ liệu. Các đường trạng thái sóng mang và tín hiệu điện thoại: CD : Modem báo cho thiết bị đầu cuối biết rằng đã nhận được một sóng mang hợp lệ từ mạng điện thoại.
RI : Các Modem tự động trả lời báo rằng đã phát hiện chuông từ mạng điện thoại địa chỉ đầu tiên có thể tới được của cổng nối tiếp được gọi là địa chỉ cơ bản (Basic Address). Các địa chỉ ghi tiếp theo được đặt tới bằng việc cộng thêm số thanh ghi đã gặp của bộ UART vào địa chỉ cơ bản. Mức tín hiệu trên chân ra RxD tùy thuộc vào đường dẫn TxD và thông thường nằm trong khoảng –12 đến +12. Các bit dữ liệu được gửi đảo ngược lại. Mức điện áp đối với mức High nằm giữa –3V và –12V và mức Low nằm giữa +3V và +12V. Trên hình 2-4 mô tả một dòng dữ liệu điển hình của một byte dữ liệu trên cổng nối tiếp RS-232C. Ở trạng thái tĩnh trên đường dẫn có điện áp –12V. Một bit khởi động (Starbit) sẽ mở đầu việc truyền dữ liệu. Tiếp đó là các bit dữ liệu riêng lẻ sẽ đến, trong đó các bit giá trị thấp sẽ được gửi trước tiên. Còn số của các bit thay đổi giữa 5 và 8. Ở cuối của dòng dữ liệu còn có một bit dừng (Stopbit) để đặt trở lại trạng thái ngõ ra (-12V). ...............................................
Cũng như ở cổng máy in, các đường dẫn tín hiệu riêng biệt cũng cho phép trao đổi qua các địa chỉ trong máy tính PC. Trong trường hợp này, người ta thường sử dụng những vi mạch có mức độ tích hợp cao để có thể hợp nhất nhiều chức năng trên một chip. Ở máy tính PC thường có một bộ phát/nhận không đồng bộ vạn năng (gọi tắt là UART: Universal Asnchronous Receiver/ Transmitter) để điều khiển sự trao đổi thông tin giữa máy tính và các thiết bị ngoại vi. Phổ biến nhất là vi mạch 8250 của hãng NSC hoặc các thế hệ tiếp theo.
Thông thường với các yêu cầu ứng dụng tốc độ thấp người ta giao tiếp qua ngõ nối tiếp, nó giao tiếp theo tiêu chuẩn RS232C và dùng để giao tiếp giữa máy tính với Modem hoặc Mouse. Ngoài ra cũng có thể dùng giao tiếp với printer hay plotter nhưng không thông dụng lắm bởi tốc độ truyền quá chậm. Đối với máy AT cho ta hai ngõ giao tiếp COM1 và COM2. Trong một số card I/O ta có thể có đến 4 cổng COM.
Để giao tiếp nối tiếp với 2 ngõ COM này Bus hệ thống của CPU (Data Bus và Address Bus) hãng IBM sử dụng hai Chip lập trình của Intel là 8250 UART (Universal Asynchronus Receiver Transmitter). Địa chỉ theo bộ nhớ của hai Chip này là 0040:0000 cho UART của ngõ COM1 và 0040:0002 cho UART của ngõ COM2 (Địa chỉ logic do hệ điều hành chỉ định) và địa chỉ theo Port để truy xuất khi sử dụng là 3F8-3FF cho COM1 và 2F8-2FF cho COM2.
Dữ liệu truyền qua cho Port COM dưới dạng nối tiếp từng Bit một, đơn vị dữ liệu có thể là 5 Bit, 6 Bit hay 1 byte tùy theo sự cài đặt lúc khởi tạo Port COM. Ngoài ra để truyền dữ liệu qua Port COM còn cần những tham số sau: Bit mở đầu cho một đơn vị dữ liệu START Bit. STOP Bit (Bit kết thúc). Parity (Kiểm tra chẵn lẻ). Baud Rate (Tốc độ truyền) tạo thành một Frame (Khung truyền).
Port COM là một thể khởi tạo bằng BIOS thông qua chức năng 0 của Interrupt 14, nạp vào thanh ghi DX1 chỉ số chọn kênh (COM1 = 0, COM2 = 1). Thanh ghi AL được nạp vào các tham số của việc truyền dữ liệu.
Mặc dù chuẩn RS_232C của EIA được dành riêng để áp dụng kết nối giữa Modem với thiết bị đầu cuối, nhưng một thuê bao của RS_232C cũng thường được sử dụng khi hai thiết bị đầu cuối được nối với nhau, hoặc một máy tính và một máy in mà không sử dụng các Modem.
Trong những trường hợp như vậy, các đường TxD và RxD phải được đặt chéo nhau và các đường điều khiển cần thiết phải được đặt ở TRUE hoặc phải được tráo đổi thích hợp bên trong cáp kết nối. Sự nối lắp cáp của RS232C mà có sự tráo đổi đường dây được gọi là Modem rỗng (null Modem).
Cáp như vậy thích hợp để nối trực tiếp 2 thiết bị DTE qua các port RS232C. Hai sơ đồ có thể kết nối lẫn nhau được trình bày trong hính 2-5 và hình 2-6 chú ý rằng trong trường hợp đơn giản nhất chỉ cần kết nối 4 dây lẫn nhau, trong thực tế 2 đường dây đất (SIG GND 0 và CHAS GND) thường được kết hợp lại, mặc dù điều này không được đề cập tới.
IV _ CÁC IC KÍCH PHÁT VÀ THU CỦA RS232C
Nhờ tính phổ biến của giao tiếp, người ta đã chế tạo các IC kích phát và thu. Hai vi mạch như vậy được Motorola sản xuất là IC kích phát MC 1488 có dạng vỏ vuông. Và MC 1489.Mỗi IC kích phát 1488 nhận một tín hiệu mức TTL và chuyển thành tín hiệu ở ngõ ra tương thích với mức điện áp của RS232C. IC 1489 phát hiện các mức vào của RS232C và chuyển chúng thành các ngõ ra có mức TTL.
V _ MINH HỌA THÔNG TIN NỐI TIẾP BẤT ĐỒNG BỘ
Đối với các máy PC, các cổng liên lạc nối tiếp (serial port) còn được gọi là các cổng COM. Hoàn toàn có thể sử dụng các cổng này để kết nối máy PC với các máy tính khác, với các Modem, các máy in, máy vẽ, các thiết bị điều khiển, mouse, mạng …
Tất cả các máy tính PC có khả năng làm việc tối đa là 4 cổng nối tiếp khi sử dụng các card giao tiếp I/O chuẩn. Các cổng nối tiếp thường được thiết kế theo các qui định RS-232 theo các yêu cầu về điện và về tín hiệu. BIOS chỉ hỗ trợ các cổng nối tiếp RS-232C. Còn các chuẩn khác như: RS-422, BiSync, SDLC, IEEE-488 (GPIB),… cần phải có các trình điều khiển thiết bị bổ sung để hỗ trợ.
......................................................
Tốc độ tối độ của cổng nối tiếp tùy thuộc vào bộ phát tốc độ Baud trong card giao tiếp cổng nối tiếp, phần mềm BIOS, và hệ thống có thể thực hiện chương trình BIOS nối tiếp nhanh đến mức nào. Ngoài ra, nếu hệ thống đang xử lý chương trình khác có độ ưu tiên cao hơn thì tốc độ tin cậy có thể bị suy giảm đáng kể.
Hoạt động của cổng nối tiếp chủ yếu cũng được xử lý bởi 1 chip UART. Các thiết kế ban đầu đã sử dụng một chip NS-8250. Các thiết bị sau này chuyển sang một phiên bản CMOS, chip 1650, có chức năng hoạt động giống như 8250. Một số thiết bị mới sử dụng chip 16550 hay các biến thể khác nhằm bổ sung thêm việc đệm dữ liệu để giảm bớt gánh nặng cho CPU.
Một phần của BIOS hệ thống (ngắt 14 h) cung cấp các dịch vụ để liên lạc với các card giao tiếp nối tiếp.
Giống như các cổng song song, POST (Power on Self Test- chương trình của BIOS tự kiểm tra cấu hình hệ thống khi bật máy) kiểm tra xem liệu một cổng nối tiếp có được gắn vào hệ thống không, và ghi lại các địa chỉ I/O của các cổng hoạt động trong vùng dữ liệu của BIOS. Tất cả các hệ thống đến 4 cổng nối tiếp, BIOS không hỗ trợ các cổng bổ sung thêm khác.
Để truy suất phần cứng của một cổng nối tiếp, cần đọc một trong 4 từ (word) trong vùng dữ liệu BIOS chứa địa chỉ I/O cơ sở đối với 4 cổng nối tiếp có thể có.
Ví dụ: Để truy suất cổng nối tiếp số 2, trước tiên phải đọc địa chỉ cổng I/O cơ sở từ vùng dữ liệu BIOS. Điều này có nghĩa là một công nối tiếp không có địa chỉ cổng I/O cố định. ......................................
Lưạ chọn cổng COM
Mỗi cổng nối tiếp sử dụng 8 byte của bộ nhớ máy PC và một ngắt phần cứng đặc biệt. Việc sử dụng các địa chỉ bộ nhớ và ngăt phần cứng này là điều quan trọng đối với người lập các chương trình liên lạc và các chương trình điều khiển thiết bị đối với các thiết bị nối tiếp.
Bảng sau mô tả các địa chỉ bộ nhớ và các ngắt phần cứng đối với 4 cổng nối tiếp chuẩn cho các máy tính tương thích với máy tính PC. Thông tin quan trọng nhất ở đây là địa chỉ cơ sở, là địa chỉ bộ nhớ đầu tiên trong mỗi cổng COM (vùng đệm phát/thu – Transmit/ Receive Buffer) địa chỉ của đường yêu cầu ngắt (IRQ) đối với mỗi cổng.
Một thiết bị nối tiếp chỉ có thể sử dụng một địa chỉ cổng COM. Khi cài đặt một Modem nội trong máy PC, hay bất kỳ thiết bị nào khác sử dụng cổng nối tiếp cho giao diện của nó, trước tiên phải đảm bảo rằng đã xác lập nó đối với một cổng COM (bao gồm địa chỉ và số IRQ).
.............................................

b. Hoạt động của cổng nối tiếp.
Sự khởi động của BIOS.
Sau khi bật máy (hay Reset máy), chương trình POST kiểm tra xem liệu có bất kỳ cổng nối tiếp nào được cài đặt hay không. POST khảo sát nhóm cổng I/O: 3F8 ¸3FEh. Để phát hiện một cổng hoạt động, thanh ghi IIR (Interrupt Identification Register) được đọc từ cổng 3FAh hay 2FAh. Nếu tất cả các bit từ 3¸7 của thanh ghi IIR đều là 0, thì POST xem như cổng nối tiếp có hoạt động.


Một khi đã xác định được nhóm cổng I/O nối tiếp có hoạt động, địa chỉ cổng I/O cơ sở được lưu trữ trong vị trí BIOS RAM cổng nối tiếp chưa sử dụng thấp nhất. Có 4 từ được dành trong RAM bắt đầu tại địa chỉ 40:0h để chứa địa chỉ I/O của cổng nối tiếp có hoạt động. Nhiều POST của các hãng cung cấp máy sẽ không bao giờ kiểm tra các cổng COM3 và COM4, vì IPM không định nghĩa một địa chỉ cổng chuẩn cho các cổng này.
Nói chung, hầu hết các hệ thống chỉ kiểm tra có 2 cổng. Tuy nhiên, các hệ thống cùng họ mới hơn thường kiểm tra 4 địa chỉ cổng có thể có. Các hệ thống MCA kiểm tra 8 địa chỉ cổng nối tiếp khác nhau có thể có trong một lần thử để tìm ra 4 cổng nối tiếp có hoạt động.

Thứ tự kiểm tra Hầu hết hệ thống Một số hệ thống AT và EISA Các hệ thống MCA Thứ 1 Thứ 2 Thứ 3 Thứ 4 Thứ 5 Thứ 6 Thứ 7 Thứ 8 3F8 2F8 Không Không Không Không Không Không 3F8 2F8 Không Không Không Không Không Không 3F8 2F8 3220h 3228h 4220h 4228h 5220h 5228h

Bảng trên mô tả thứ tự theo đó các BIOS sẽ tìm kiếm các cổng hoạt động. Chỉ cổng I/O cơ sở đối với mỗi nhóm được hiển thị trong bảng này. Trên hệ thống MCA, một khi 4 cổng đã được tìm thấy, các cổng khác không được kiểm tra nữa.
Khi hoàn tất các công việc kiểm tra POST nối tiếp, các địa chỉ cổng nối tiếp được cất giữ. Điều này thường tạo ra một trong 4 trường hợp được mô tả trong bảng sau:

Địa chỉ RAM Cổng nối tiếp Trường hợp 1 Địa chỉ I/O Trường hợp 2 Địa chỉ I/O Trường hợp 3 Địa chỉ I/O Trường hợp 4 Địa chỉ I/O 40:0h 40:2h 40:4h 40:6h 1 2 3 4 3F8 2F8 0 0 3F8 0 0 0 2F8 0 0 0 0 0 0 0
Các kết quả POST có thể có về việc phát hiện cổng nối tiếp.
Trường hợp 1 : Mô tả POST phát hiện 2 cổng nối tiếp. Trường hợp 2 và 3 : Cho thấy chỉ có một cổng nối tiếp được phát hiện. Trường hợp 4 : Cho thấy không phát hiện được cổng nối tiếp nào.
Các phép thử này không khẳng định liệu có một thiết bị nối tiếp thực sự được nối với cổng I/O hay không. Phép thử chỉ kiểm tra xem liệu phần cứng cổng nối tiếp có tồn tại hay không tại một địa chỉ I/O cụ thể. Tổng số cổng nối tiếp hoạt động được phát hiện thấy (0 ¸ 4) được cất giữ trong byte thiết bị tại địa chỉ BIOS RAM 40:10h từ các bit 9 ¸ 11.
Quá trình phát nối tiếp
Để phát một byte trên đường dây kết nối nối tiếp, cổng được giả định là đã được khởi sự với tốc độ baud và các phần chọn khung (Frame) nối tiếp thích hợp. Chúng ta cũng giả định rằng các byte sẽ được phát đi trên cổng nối tiếp số 1 (COM1).
Trước tiên, xác định địa chỉ cơ sở cổng I/O bằng cách đọc một từ (Word) từ vùng dữ lệu BIOS tại 40:OH đối với cổng nối tiếp COM1. Nếu trị = 0: Không có cổng nối tiếp hoạt động nào được gắn ở đây và dĩ nhiên không có dữ liệu nào được gửi đi. Hai đường điều khiển MODEM là DTR (DATA Terminal Ready) và RTS (Request to Send) được xác lập lên mức cao (DTR = 1, RTS = 1).
DTR thông báo cho thiết bị kết nối biết rằng máy tính đang hoạt động và sẵn sàng để liên lạc. RTS báo cho thiết bị kết nối biết rằng máy tính muốn gửi dữ liệu. Hai đường này được kích khởi bằng cách ghi trị 3 thanh ghi MCR (MODEM control Regester) của UART.
Kế đó, kiểm tra hai đường trạng thái CTS (Clear To Send). Những đường này nằm trong các bit 4 và 5 của thanh ghi MSR (MODEM Status Regester).
DSR báo cho máy tính biết thiết bị kết nối đã được bật lên và sẵn sàng. CTS báo cho máy tính biết rằng thiết bị kết nối đã sẵn sàng đối với dữ liệu.
Các đường trạng thái này nên được kiểm tra trong 2ms hay cho đến khi cả hai đều chuyển sang mức cao. Khi cả hai đường này đều ở mức cao, thiết bị được kết nối với cổng nối tiếp đã báo hiệu cho biết nó đã sẵn sàng cho một byte. Một lỗi đáo hạn (timeout error) được báo hiệu bởi phần mềm nếu một trong hai đường dẫn còn ở mức thấp lâu hơn khoảng 2ms.
Đến đây thiết bị kết nối đã sẵn sàng tiếp nhận một byte, UART phải được kiểm tra xem liệu thanh ghi chứa dữ liệu phát THR (Transmit Holding Regester) đã sẵn sàng có một byte chưa. Thanh ghi LSR (Line Status Regester), bit 5, được xác lập lên mức cao khi thanh ghi chứa dữ liệu này trống rỗng và sẵn sàng cho một byte. Một lần nữa, giống ở bước 3 nếu thanh ghi THR không thể trở nên hữu dụng trong 2ms, thì phần mềm sẽ báo một lỗi đáo hạn, và bỏ qua việc phát đi. Nếu cho đến bây giờ chưa xảy ra việc đáo hạn, byte có thể được gửi đến thanh ghi chứa dữ liệu phát của UART. Sau đó, UART phát byte từ thanh ghi chứa dữ liệu phát vào thanh ghi dịch TSR (từ đây các bit dữ liệu được dịch ra và gửi đi), và tạo dạng khung nối tiếp.
Quá trình nhạn nối tiếp.
Để nhận 1 byte từ đường dây kết nối nối tiếp, cổng được giả định như trên (cho cổng COM3):
Trước tiên, xác định địa chỉ cơ sở cổng I/O bằng cách đọc một từ (Word) từ vùng dữ liệu BIOS tại 40:4H đối với cổng nối tiếp COM3. Nếu trị = 0: Không có cổng nối tiếp hoạt động nào được gắn ở đây và dĩ nhiên không có dữ liệu nào được gửi đi. Hai đường điều khiển MODEM là DTR (DATA Terminal Ready) và RTS (Request to Send) được xác lập lên mức cao (DTR = 1, RTS = 1).
Điều này thông báo cho thiết bị kết nối biết rằng máy tính đang hoạt động và sẵn sàng liên lạc. Điều này được thực hiện bằng cách ghi trị 1 các thanh ghi MMC của UART.
Kế đó kiểm tra tín hiệu trên đường trạng thái DSR. Tín hiệu này xuất hiện trong bit 5 của thanh ghi MSR. DSR báo cho máy tính biết rằng thiết bị kết nối đã được bật lên và sẵn sàng. DSR sẽ được kiểm tra cho đến khi nó lên mức cao hay cho đến khi hết 2ms trước khi một lỗi đáo hạn được báo hiệu.
Kế đó, vùng đêm nhận được kiểm tra để xem dữ liệu đã nhận được dữ liệu nào chưa. Bit 0 của thanh ghi LSR chứa một cờ hiệu báo dữ liệu đã sẵn sàng. Nó được xét lên 1 khi vùng đệm có dữ liệu. Nếu cờ báo dữ liệu sẵn sàng không được xét sau 2ms, thì phần mềm sẽ khai báo một lỗi đáo hạn, và tác vụ bị bỏ qua. Nếu cho đến bây giờ chưa xảy ra việc đáo hạn, byte có thể được đọc từ vùng đệm nhận của UART.
Trong chế độ bất đồng bộ, 8251 A dịch số liệu trên dây RxD từ bit một. Sau mỗi bit, thanh ghi thu được so sánh với thanh ghi chứa ký tự SYN. Nếu hai thanh ghi chưa bằng nhau thì 8251 A dịch bit khác và tiếp tục so sánh cho đến khi hai thanh ghi bằng nhau. 8251 A kết thúc chế độ bất đồng bộ và đưa tín hiệu SYNDET (Synch Detect) để báo đồng bộ đã hoàn tất. Nếu USART được nạp từ điều khiển để làm việc với hai ký tự SYNC, quá trình bất đồng bộ cũng như trên. Nhưng hai ký tự kế tiếp nhau sẽ được so sánh với hai ký tự SYNC trước khi đạt được sự đồng bộ. Ở chế độ bất đồng bộ bit chẵn/lẻ sẽ không phải kiểm tra. USART ở chế độ đuổi bắt đồng bộ với hai điều kiện: USART được khởi động ở chế độ đồng bộ. USART đã nhận lệnh ở chế độ bất đồng bộ.

Khối phát
Khối này nhận số liệu song song từ đơn vị trung tâm, chèn thêm các thông tin rồi chuyển sang nối tiếp và gửi ra thân TxD (Transmiter DATA).
Ở chế độ bất đồng bộ, khối phát chèn thêm bit START, bit kiểm tra chẵn lẻ paraty và một hay hai bit STOP. Trong chế độ đồng bộ, khối phát chèn thêm các ký tự SYNC. Những ký tự đồng bộ này phải được phát trước khi bản tin bắt đầu. Nếu trong khi phát có khoảng trống giữa hai ký tự thì USART tự động chèn các ký tự đồng bộ vào. Trong cả hai chế độ đồng bộ và bất đồng bộ, quá trình phát chỉ được cho phép khi tín hiệu TxE (Transmiter Enable) và tín hiệu CTS, ở trạng thái tích cực. Nếu USART được đặt ở chế độ đồng bộ từ ngoài, chân SYNDET sẽ là cửa vào và nhận tín hiệu để đồng bộ khi thu. Khối phát có thể gửi tín hiệu cắt (BREAK). Đó là một chu kỳ liên tục các bit SPACE trên đường dây liên tục và đưọc dùng ở chế độ truyền song công để cắt quá trình gửi thông tin ở đầu cuối.
USART sẽ gửi tín hiệu cắt liên tục nếu bit D3 của byte lệnh được thiết lập
Khối điều khiển Modem
Khối này tạo và nhận tín hiệu RTS (Request to Send).
Ngoài ra, còn có các tín hiệu ra DTR (Data Terminel Ready) và tín hiệu vào DSR (Data Set Ready). Đó là những tín hiệu vạn năng. Tín hiệu DTR điều khiển bởi bit D2 bởi byte lệnh. Tín hiệu DSR thể hiện ở bit D7 của thanh ghi trạng thái. USART không định nghĩa các tín hiệu này một cách cứng ngắc. Thông thường:
Tín hiệu DTR qua Modem để chỉ rằng thiết bị đầu cuối sẵn sàng truyền. DSR là tín hiệu từ Modem để chỉ trạng thái sẵn sàng liên lạc.
qKhối điều khiển vào/ra
Logic điều khiển đọc/ghi giải mã các tín hiệu điều khiển từ Bus điều khiển của đơn vị trung tâm thành những tín hiệu đều khiển các cổng dẫn số liệu đến Bus nội của USART.
Bảng sau cho biết sự liên quan giữ các tín hiệu CE, C/D\ RD\
CE C/D\ RD\ WR\ Ý Nghĩa 0 0 0 0 1 0 1 0 1 x 0 0 1 1 x 1 1 0 0 x CPU đọc số liệu từ USART CPU đọc trạng thái từ USART CPU ghi số liệu vào USART CPU ghi lệnh vào USART Bus của USART ở trạng thái trở kháng cao
Khối thu
Khối thu nhận dữ liệu nối tiếp ở chân RxD và chuyển thành số liệu song song (P/PC). Trước khi bộ thu làm việc, bit D2 trong Command world của byte lệnh phải ở trạng thái cho phép. Nếu bit này không được lập, bộ thu sẽ không tạo ra tín hiệu RxRDI.
Trong chế độ bất đồng bộ, 8251 A kiểm tra mức điện áp của đầu vào RxD. Khi có thay đổi mức logic từ 1 xuống 0, 8251 A khởi động bộ đếm thời gian trong khối thu khi đặt thời gian ½ bit, 8251 A kích mẫu đầu vào RxD. Tại thời điểm này có 2 trường hợp xảy ra:
Nếu đầu vào RxD có mức logic cao thì sự thay đổi từ 1 xuống 0 ở RxD trước lúc kích mẫu là do nhiễu hay khối thu đã khởi động bộ đếm trong khi nhận bit số liệu. Như vậy có sai 8251 bỏ lệnh đang thực hiện và chuẩn bị ký tự mới. Nếu đầu vào RxD có mức logic thấp trong thời điểm kích mẫu. 8251 tiếp tục kích mẫu để nhận giá trị của các bit số liệu, bit kiểm tra chẵn lẻ và các bit dừng. Sau đó, 8251 tách các bit khung và chuyển số liệu qua Bus trong đến thanh ghi đệm số liệu thu. Tín hiệu RxRDI được tạo ra để báo cho trung tâm biết số liệu thu đã sẵn sàng. Trong chế độ đồng bộ, khối thu kích mẫu các bit số liệu của ký tự rồi đưa đến đệm số liệu thu và lập cờ RxRDI. Vì bộ thu nhóm một số bit thành ký tự nên được xác định bit số liệu đầu tiên là cần thiết. Để đồng bộ giữa bộ thu và bộ phát, nếu có trống trong dãy ký tự thì 8251 tự động chèn ký tự SYNC vào. Quá trình đồng bộ được thực hiện trong quá trình bất đồng bộ.
Khối đệm vào ra
Khối đệm vào ra chứa: Thanh ghi trạng thái, thanh ghi số liệu thu (thanh ghi đệm số liệu thu), thanh ghi số liệu phát và lệnh (thanh ghi đệm số liệu phát và lệnh). Như vậy, chỉ có một thanh ghi chứa thông tin chuyển từ đơn vị trung tâm vào USART. Thông tin này bao gồm số liệu và lệnh, do vậy phải có sự phân chia thời gian giữa lệnh và số liệu. Lệnh phải được gửi trước số liệu. Trước khi gửi số liệu vào USART. Đơn vị trung tâm phải kiểm tra tín hiệu sẵn sàng phát TxRDI. Nếu gửi thông tin khi TxRDI ở trạng thái chưa sẵn sàng số liệu chuyển đi có thể sai
..........................................
CHƯƠNG I
ĐẠI CƯƠNG VỀ ĐIỀU KHIỂN THEO
CHƯƠNG TRÌNH SỐ

I _ KHÁI NIỆM VỀ ĐIỀU KHIỂN THEO CHƯƠNG TRÌNH SỐ

Ở máy thông thường việc điều khiển chuyển động cũng như thay đổi vận tốc của các bộ phận máy điều khiển được thực hiện bằng tay. Với cách điều khiển này thời gian phụ thuộc khá lớn, nên không thể nâng cao năng suất lao động.
Để giảm thời gian phụ, cần thiết tiến hành tự động hóa quá trình điều khiển. Trong sản xuất hàng khối, hàng loạt lớn, từ lâu người ta dùng phương pháp gia công tự động với việc tự động hóa quá trình điều khiển. Đặc điểm của loại máy tự động này là rút ngắn thời gian phụ, nhưng thời gian chuẩn bị sản xuất quá dài (thời gian thiết kế và chế tạo,thời gian điều chỉnh máy …). Nhược điểm này không đáng kể, nếu sản xuất với khối lượng lớn. Trái lại với lượng sản xuất nhỏ, mặt hàng thay đổi thường xuyên, loại máy tự động trở nên không kinh tế. Do đó cần phải tìm ra phương pháp điều khiển mới, đảm bảo thời gian điều chỉnh máy để gia công từ loại chi tiết này sang chi tiết khác được nhanh. Yêu cầu này được thực hiện với việc điều khiển theo chương trình.
Điều khiển theo chương trình là một dạng điều khiển tự động mà tín hiệu điều khiển (tín hiệu ra) được thay đổi theo một qui luật trước. Nói cách khác, trên máy điều khiển theo chương trình, thứ tự, giá trị của các chuyển động cũng như thứ tự đóng mở các bộ phận máy, đóng mở hệ thống làm nguội, bôi trơn, thay mũi khoan… Điều được thực hiện đúng theo một chương trình đã vạch sẵn. Các cơ cấu mang chương trình này được đặt vào thiết bị điều khiển, và sẽ làm tự động theo chương trình đã cho.
Nếu các chương trình trên được ghi lại bằng các dấu tì, bằng hệ thống cam, bằng mẫu ghép hình … Ta gọi hệ thống điều khiển đó là hệ thống điều khiển theo chương trình phi số. Nếu các chương trình được biểu thị bằng các chữ số dưới dạng mã hiệu, ta gọi hệ điều khiển theo chương trình số.
Như vậy điều khiển theo chương trình số là một quá trình tự động cho phép đưa một cơ cấu di động từ vị trí này đến vị trí khác bằng một lệnh. Sự dịch chuyển ấy có thể là lượng di động thẳng (hoặc một góc quay theo các bậc tự do).
Trong nhiều trường hợp, phương pháp điều khiển theo chương trình số được thiết kế tự động hóa việc di chuyển một cơ cấu từ vị trí này đến vị trí khác, ta gọi là "điều khiển theo điểm". Nhưng ta cũng dễ dàng khi rút ngắn vô hạn khoảng cách giữa các điểm di động kế tiếp nhau và sẽ đạt đến một quá trình điều khiển quỹ đạo gọi là điều khiển theo đường.
Phương pháp điều khiển theo chương trình số có thể dùng để di động bất kỳ một cơ cấu nào được truyền động bằng động cơ. Phạm vi sử dụng nó rất rộng, nhưng chủ yếu là tự động hóa máy công cụ.
Vì chương trình số có thể tiến hành cách xa máy và máy có hệ thống đo lường riêng, nên hệ thống điều khiển này có thể điều khiển một cách dể dàng và nhanh chóng.
Hệ thống điều khiển theo chương trình số còn được gọi tắt là hệ thống NC (Numerical Control) và máy điều khiển theo chương trình số được gọi là máy NC. Như thế: Máy NC là loại máy công cụ hoạt động tự động một phần hoặc toàn phần với các lệnh được thể hiện bằng dạng tín hiệu là các chữ số được ghi trên băng từ, đĩa từ hoặc phim…
Bước phát triển cao của máy điều khiển theo chương trình số là sự ra đời của trung tâm gia công CNC. Vậy trung tâm gia công là một loại máy điều khiển theo chương trình số có cơ cấu tự động để thực hiện nhiều loại nguyên công khác nhau sau một lần kẹp chi tiết, với sự trợ giúp của máy tính điện tử.
CNC có thể phân thành 2 loại: Loại dùng để gia công có dạng thân hộp tấm, loại gia công chi tiết tròn xoay.

II _ ĐẶC ĐIỂM CỦA CNC
Tập trung nguyên công cao độ. Có cơ cấu cấp dao tự động với dung lượng lớn. Phần lớn CNC thường có bàn máy phụ và đồ gá. Đạt được độ chính xác cao ở nguyên công tinh. Các CNC thường dùng hệ thống điều khiển theo đường.
III _ HỆ TOẠ ĐỘ MÁY
Các điểm mà trong khi gia công được xác định trong một chương trình để mô tả vị trí của các điểm náy trong vùng làm việc, ta dùng hệ tọa độ. Nó bao gồm ba trục vuông góc với nhau cũng cắt nhau tại điểm gốc 0.
Với hệ toạ độ ba trục, bất kỳ điểm nào cũng được xác định thông qua các tọa độ của nó. Hệ tọa độ máy do nhà chế tạo xác định, thông thường nó không thể thay đổi
..........................................................
trục x và ngón tay trỏ sẽ chỉ theo chiều của trục Y. Hệ toạ độ cơ bản được gắn liền với chi tiết.

Bởi vậy khi lập trình ta phải luôn luôn xuất phát từ chổ xác định chi tiết đứng yên còn mũi khoan thì chuyển động. Điều đó có nghiã là: Khi khoan rõ ràng chi tiết chuyển động là chính, nhưng để đơn giản hơn cho việc lập trình hãy quan niệm là chi tiết đứng yên còn mũi khoan thì dịch chuyển. Ta gọi đó là chuyển động tương đối của mũi khoan. Để mô tả đường dịch chuyển của mũi khoan (dữ liệu tọa độ) trên một số máy CNC có cả hai khả năng. Dùng toạ độ Đề_Cac : Khi dùng dữ liệu toạ độ Đề Các, ta đưa ra khoảng cách đo song song với trục từ một điểm tới một điểm khác. Các khoảng cách theo chiều dương của trục có kèm theo dấu dương (+) phía trước. Các khoảng cách theo chiều âm của trục có kèm theo dấu âm (-) phía trước. Các số đo có thể đưa ra theo hai phương thức: Đo tuyệt đối: Với các số đo tuyệt đối, ta đưa ra tọa độ các điểm đích tính từ một điểm cố định trong vùng làm việc. Nghĩa là trong mỗi chuyển động đều xác định mũi khoan phải dịch chuyển đến đâu kể từ một điểm gốc 0 tuyệt đối. Đo theo chuổi kích thước: Với các số đo theo chuỗi kích thước, ta đưa ra tọa độ các điểm đích tính từ các điểm dừng lại của mũi khoan sau một lổ khoan được khoan. Nghĩa là trong mỗi chuyển động đều đưa ra số liệu của mũi khoan cần được dịch chuyển tiếp một lượng là bao nhiêu nữa theo từng trục toạ độ. Dùng tọa độ cực : Khi sử dụng các dữ liệu trong hệ tọa độ cực, ta đưa ra vị trí của một điểm thông qua khoảng cách và góc so với một trục cơ sở. Các tọa độ cực chỉ có thể đo trên một mặt phẳng chính. Trong phạm vi của một hệ tọa độ cực có 3 mặt phẳng chính. Từ 3 trục x, y và z của hệ thống sẽ có 3 mặt kẹp, đó là: Mặt x/y, mặt x/z, mặt y/z. Những điểm quan trọng trong một hệ tọa độ cực Điểm chuẩn : Là điểm gốc 0 của hệ tọa độ máy. Điểm 0 chi tiết : Là điểm gốc 0 của hệ tọa độ chi tiết, nó được giữ cố định cho một chi tiết. Điểm 0 lập trình : Là điểm gốc 0 từ đó xác định các dữ liệu cập nhật trong một chương trình. Điểm này có thể thay đổi thông qua lệch dịch chuyển điểm 0. IV _ CÁC DẠNG ĐIỀU KHIỂN Phù hợp với yêu cầu đa dạng trong thực tế, người ta phân biệt hệ điều khiển theo ba mức điều khiển khác nhau : Điều khiển theo điểm. Điều khiển theo đoạn. Điều khiển theo đường. Điều khiển theo điểm:
Là hệ thống điều khiển không có mối quan hệ hàm số (vô hàm) giữa các chuyển động dọc theo trục tọa độ. Nhiệm vụ chủ yếu của hệ thống điều khiển là định vị chính xác mũi khoan hoặc chi tiết vào ví trí yêu cầu. Hệ thống này không kiểm tra theo qũi đạo, vận tốc, mà kiểm tra theo vị trí định vị.

Điển hình nhất của hệ thống này là điều khiển để khoan lỗ tức là cần điều khiển chuyển động tương đối giữa dao và phôi đến từng điểm xác định. Chẳng hạn từ điểm A(X1,Y1 ), B(X2,Y2 ). Đặc điểm của loại điều khiển này là trong quá trình điều khiển mũi khoan không làm việc. Quá trình gia công chỉ được tiến hành theo bất cứ tọa độ nào: Có thể trước tiên theo tọa độ X, sau đó theo Y hoặc ngược lại, hoặc đồng thời thực hiện cùng một lúc trên hai trục với vận tốc lớn nhất . Điều khiểu theo đoạn
Cũng giống như hệ thống điều khiển theo điểm, tức là không có quan hệ hàm số giữa các chuyển động theo tọa độ. Điểm khác là khi định vị, mũi khoan làm việc nên không thể định vị theo một đường bất kỳ, mà thông thường phải theo hướng song song với một trục tọa độ. Error! Bookmark not defined.GHI
Sơ đồ cấu trúc hệ thống điều khiển theo điểm và đoạn khởi đầu bằng các số liệu về hình dáng và số liệu công nghệ chi tiết gia công. Hai số liệu ấy tạo thành dữ liệu gia công. Thông qua quá trình lập trình, nhờ cơ cấu ghi mã hiệu, các dữ liệu gia công được biến thành các mã hiệu ghi vào chương trình. Chương trình này bao gồm tất cả mọi tín hiệu cần thiết cho việc điều khiển các cơ cấu của máy.
Những khâu kể trên có thể thực hiện ở bất cứ nơi nào, tách xa khởi máy, nên gọi là phần xử lý dữ liệu bên ngoài. Dữ liệu gia công cũng có thể đưa trực tiếp vào bảng điều khiển số đặt trên máy (như máy NC đơn giản) hoặc truy nhập trực tiếp vào máy tính trung tâm như ở hệ thống CNC. Các khâu kế tiếp của xích điều khiển điều đặt bên trong máy, nên gọi là phần xử lý dữ liệu bên trong.
Khâu đầu tiên của phần xử lý dữ liệu bên trong là cơ cấu đọc. Vì chương trình ghi các dữ liệu gia công dưới dạng mã hiệu, nên phải qua cơ cấu giải mã để biến mã hiệu thành những tín hiệu điều khiển: Tín hiệu hành trình và tín hiệu khởi động.
Tín hiệu khởi động có nhiệm vụ đóng ngắt các cơ cấu tác động, nên ta không đề cập đến trong sơ đồ cấu trúc. Còn tín hiệu hành trình là những trị số đã được xác định để định vị bàn máy theo tọa độ X-Y. Tín hiệu hành trình cần đưa qua cơ cấu chuyển đổi, nhằm tạo nên những tín hiệu giống nhau để đưa vào cơ cấu so sánh.
Cơ cấu so sánh có hai tín hiệu vào: một tín hiệu là những trị số xác định từ chương trình đưa đến gọi là giá trị cần, một tín hiệu là những trị số thực tế từ thiết bị đo hành trình của bàn máy đưa đến gọi là giá trị thực. Qua cơ cấu so sánh, nếu hai gía trị chênh lệch nhau, sẽ tạo nên một tín hiệu sai lệch. Qua cơ cấu khuếch đại, tín hiệu sai lệch làm khởi động động cơ (động cơ quay bàn máy) để bù sai số. Khi đạt đến vị trí đã định, giá trị cần và giá trị thực bằng nhau, tín hiệu sai lệch sẽ bằng không, cơ cấu khởi động dừng.
SƠ ĐỒ CẤU TRÚC
HỆ THỐNG ĐIỀU KHIỂN THEO ĐIỂM VÀ ĐOẠN
CHƯƠNG II
TRUYỀN ĐỘNG BẰNG ĐỘNG CƠ BƯỚC
I _ CẤU TẠO VÀ PHÂN LOẠI ĐỘNG CƠ BƯỚC
Động cơ bước được phân thành ba loại chủ yếu sau :
Động cơ nam châm vĩnh cửu : Hay còn gọi là động cơ bước kiểu tác dụng và thường được chế tạo có cực móng. Động cơ này có góc bước thay đổi từ 60¸ 450 trong chế độ điều khiển bước đủ, mômen hãm từ 0,5 ¸ 25 Ncm, tần số khởi động lớn nhất là 0,5 và tần số làm việc lớn nhất ở chế độ không tải là 5 Khz.
Hình 2-1: Cấu tạo động cơ bước vĩnh cửu
1 và 2) Hai nửa Stator có dạng cực móng được từ hóa với cực N và S xen kẻ nhau; 3) Hai cuộn stato (một cuộn điều khiển đơn cực và một cuộn điều khiển lưỡng cực) được đặt ở bên trong hai nửa stator; 4)Rotor nam châm vĩnh cửu có các cực từ xen kẻ.
Động cơ bước có từ trở thay đổi : Hay còn gọi là động cơ phản kháng. Kiểu động cơ này có góc nằm trong giới hạn từ 1,80 ¸ 300 trong chế độ điều khiển bước đủ, mômen hãm từ 1¸ 50 Ncm, tần số khởi động lớn nhất là 1 Khz, và tần số làm việc lớn nhất trong điều kiện không tải là 20 Khz. Stato được chế tạo thành dạng răng với bước cực bs. Cuộn dây pha (2) được quấn trên 2 hoặc 4 răng đối xứng nhau, roto của động cơ cũng được chế tạo thành dạng răng có bước cực br.
...............................................
Hình 2-2 :Cấu tạo động cơ bước có từ trở thay đổi 1) Stato được chế tạo thành dạng răng; 2) Cuộn dây pha; 3) Roto có từ trữ thay đổi được chế tạo thành dạng răng. Động cơ bước hổn hợp :

Hay còn gọi là động cơ bước cảm ứng, có góc bước thay đổi trong khoảng 0,36 - 150 trong chế độ bước đủ, mômen hãm từ 3 - 1000 Ncm, tần số khởi động lớn nhất là 40 khz. Trong các loại động cơ bước kể trên thì động cơ bước hổn hợp được sử dụng nhiều hơn cả. Vì loại động cơ này kết hợp các ưu điểm của hai loại động cơ trên đó là: Động cơ nam châm vĩnh Cửu với dạng cực móng, và động cơ có từ trở thay đổi.

Cấu tạo của động cơ bước thay đổi hổn hợp là sự kết hợp giữa động cơ bước nam châm vĩnh cữu và động cơ bước có từ trở thay đổi. Phần Stato được cấu tạo hoàn toàn giống Stator của động cơ bước có từ trở thay đổi. Trên các cực của Stato được đặt các cuộn dây pha, mỗi cuộn dây pha được quấn thành 4 cuộn dây (h.2-3) hoặc được quấn thành 2 cuộn dây (h.2-4) đặt xen kẻ nhau để hình thành lên các cực N và S đồng thời đối diện với mỗi cực của bối dây là răng của Roto và cũng được đặt xen kẽ giữa hai vành răng số 3 của Roto.
................................
CHƯƠNG iv
ỨNG DỤNG

1_ KHÁI QUÁT VỀ HỆ ĐỊNH VỊ BA CHIỀU
Một hệ thống định vị ba chiều là hệ thống có khả năng điều chỉnh vị trí của một điểm trong không gian để thực hiện bằng ba tọa độ xyz. Hệ thống ta biết ở đây là một máy khoan mạch in được điều khiển theo chương trình bằng máy tính. Khi muốn khoan một lỗ mạch in thì ta nhập tọa độ xy từ bàn phím, lúc đó bàn khoan sẽ dịch chuyển theo hai chiều xy và sẽ dừng lại khi đến đúng tọa độ (xy). Sau đó mũi khoan sẽ dịch chuyển theo phương z từ trên xuống để thực hiện công việc khoan mạch in.
2_ SƠ ĐỒ KHỐI MÁY KHOAN
Chương trình điều khiển máy khoan được viết trên phần mềm PAL-EP bằng các lệnh, người sử dụng nhập tọa độ vị trí các lỗ khoan từ bàn phím, các vị trí lỗ khoan sẽ được lưu trữ trên một tập tin trong đĩa, tập tin này có thể gọi lại để bổ xung, chỉnh sửa bởi hệ thống của chương trình.
Sau khi đã nhập xong dữ liệu các lỗ cần khoan, người sử sụng ra lệnh cho máy khoan làm việc. Trước khi máy khoan thực hiện công việc khoan, thì chương trình sẽ tự động khoan theo thứ tự. Máy tính chỉ làm nhiệm xử lý dữ liệu theo người viết chương trình.
.................................

3_ CHƯƠNG TRÌNH ĐIỀU KHIỂN
Chương trình điều khiển được viết bằng các lệnh, khi nhập tọa độ các lỗ khoan của tấm mạch in có kích thước xác định, hệ thống máy khoan sẽ hoạt động theo chương trình điều khiển để khoan các điểm có tọa độ nhập vào.
Để điều khiển máy khoan, đầu tiên máy khoan phải được Reset về tọa độ gốc (0,0). Sau khi máy Reset về (0,0) hay đến tọa độ mong muốn làm nhiệm vụ khoan của mình. Máy tính sẽ điều khiển hệ thống khoan tuần tự theo x,y,z…
Tín hiệu ra từ máy tính sẽ điều khiển cho động cơ hoạt động, ban đầu động cơ x hoạt động cho đến khi đến điểm quy định thì dừng lại, tiếp theo là động cơ y hoạt động làm cho máy khoan di chuyển theo chiều y và động cơ y sẽ dừng lại khi đến điểm quy định. Động cơ x,y dừng lại thì đến động cơ z sẽ hoạt động liền sau đó để đưa mũi khoan xuống điểm quy định.
Muốn cho các động cơ xyz dừng đúng vị trí cần khoan, máy khoan cần có hệ thống phản hồi về máy tính. Máy tính sẽ nhận xung phản hồi và so sánh với tọa độ điểm cần khoan rồi mới điều khiển đường đi kết tiếp của động cơ.
Trên đây là quy trình dùng khoan một lỗ, muốn khoan nhiều lỗ trên mạch in thì ta nhập tọa độ các điểm cần khoan và máy sẽ hoạt động khoan tuần tự đến điểm cuối cùng. Sau đó Reset về tọa độ gốc (0,0).
4 _ CHƯƠNG TRÌNH KHOAN VI MẠCH 40 CHÂN

